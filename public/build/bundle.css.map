{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "..\\..\\DiaSemana.svelte",
    "..\\..\\Loading.svelte",
    "..\\..\\CitasProgramadas.svelte",
    "..\\..\\Index.svelte",
    "..\\..\\Crear.svelte",
    "..\\..\\CrearCita.svelte",
    "..\\..\\Gestion.svelte",
    "..\\..\\EspacioTrabajo.svelte",
    "..\\..\\Perfil.svelte",
    "..\\..\\SolicitudDetalle.svelte",
    "..\\..\\Index.svelte"
  ],
  "sourcesContent": [
    "<script>\r\n  import { createEventDispatcher } from 'svelte';\r\n  import Horario from \"./Horario.svelte\";\r\n  import Tanda from \"./Tanda.svelte\";\r\n\r\n  export let item = {};\r\n  export let tandas = {};\r\n  export let horarios = {};\r\n  export let medicoID = {};\r\n  $: horariosFiltrados = horarios.filter(x => x.dia == item.dia);\r\n\r\n  const dispatch = createEventDispatcher();\r\n  \r\n  const actualizar = function () {\r\n    dispatch('cambioHorario')\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .card.card-vnc {\r\n    box-shadow: none;\r\n    border: #687ae8 solid 1px;\r\n  }\r\n</style>\r\n\r\n<div class=\"card m-b-30 card-vnc\">\r\n  <div class=\"card-header\">\r\n    <h5 class=\"m-b-0\">\r\n      <div\r\n        class=\"custom-control custom-checkbox\"\r\n        style=\"margin-left: 15px; padding-left: 0;\">\r\n        <input\r\n          type=\"checkbox\"\r\n          class=\"custom-control-input\"\r\n          id={item.dia}\r\n          bind:checked={item.check}\r\n          disabled />\r\n        <label class=\"custom-control-label\" for={item.dia}>{item.nombre}</label>\r\n      </div>\r\n    </h5>\r\n  </div>\r\n  <div class=\"card-body\">\r\n    <div class=\"row\">\r\n      {#each tandas as i}\r\n        <Tanda on:cambioHorario={actualizar} {i} {horarios} dia={item.dia} {medicoID}/>\r\n      {/each}\r\n    </div>\r\n\r\n    {#each horariosFiltrados as horario}\r\n      <Horario on:cambioHorario={actualizar} {horario} />\r\n    {/each}\r\n\r\n  </div>\r\n</div>\r\n",
    "<div class=\"lds-ring\"><div></div><div></div><div></div><div></div></div>\r\n<style>\r\n    .lds-ring {\r\n  display: inline-block;\r\n  position: relative;\r\n  width: 10px;\r\n  height: 10px;\r\n}\r\n.lds-ring div {\r\n  box-sizing: border-box;\r\n  display: block;\r\n  position: absolute;\r\n  width: 34px;\r\n  height: 34px;\r\n  border: 4px solid #cef;\r\n  border-radius: 50%;\r\n  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\r\n  border-color: #cef transparent transparent transparent;\r\n}\r\n.lds-ring div:nth-child(1) {\r\n  animation-delay: -0.45s;\r\n}\r\n.lds-ring div:nth-child(2) {\r\n  animation-delay: -0.3s;\r\n}\r\n.lds-ring div:nth-child(3) {\r\n  animation-delay: -0.15s;\r\n}\r\n@keyframes lds-ring {\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n</style>",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { connection, activePage, session, axios, dataCita, errorConexion, toast }\r\n    from \"../../store.js\";\r\n  import { onMount } from \"svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import moment from \"moment\";\r\n  // import Swal from \"sweetalert2\";\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n  $activePage = \"citasProgramadas\";\r\n\r\n  onMount(() => {\r\n    moment.locale('es-DO');\r\n    jQuery(\"#sltMedicos\").select2();\r\n    jQuery(\"#sltMedicos\").on(\"select2:select\", e => {\r\n      let data = e.params.data;\r\n      idMedico = data.id;\r\n      cargarCitas()\r\n    });\r\n\r\n    cargarEstados();\r\n    cargarMedicos();\r\n    cargarCitas();\r\n  });\r\n\r\n  let horasDisponibles = [];\r\n  let citasPendientes = [];\r\n  let citasRealizadas = [];\r\n  let medicos = [];\r\n  let estados = [];\r\n  let idMedico = \"\";\r\n  let fecha = \"\";\r\n  let tandaID = 0;\r\n  let paciente = {\r\n    id: \"\",\r\n    nombre: \"\",\r\n    apellido: \"\",\r\n    cedula: \"\",\r\n    correo: \"\",\r\n    telefono: \"\",\r\n    aseguradoraID: 0,\r\n    nombreAseguradora: \"\",\r\n    provinciaID: 0,\r\n    nacionalidad: \"\",\r\n    noAfiliado: \"\",\r\n    sexo: \"\",\r\n    direccion: \"\",\r\n    observaciones: \"\"\r\n  };\r\n  let cita = {\r\n    id: 0,\r\n    medicoID: \"\",\r\n    pacienteID: \"\",\r\n    aseguradoraID: 0,\r\n    estadoID: 1,\r\n    fecha: \"\",\r\n    observaciones: \"\",\r\n    inactivo: false,\r\n  };\r\n  let filter = {\r\n    medicoID: \"\",\r\n    fechaInicio : \"\",\r\n    fechaFin : \"\",\r\n    estadoID : \"\",\r\n    nombrePaciente : \"\"\r\n  }\r\n  let provincias = [\r\n    { id: 1, nombre: \"Duarte\" },\r\n    { id: 2, nombre: \"Santiago\" },\r\n    { id: 3, nombre: \"Distrito Nacional\" }\r\n  ];\r\n  let aseguradoras = [\r\n    { id: 1, nombre: \"SENASA\" },\r\n    { id: 2, nombre: \"HUMANO SEGURO\" },\r\n    { id: 3, nombre: \"RENACER\" },\r\n    { id: 4, nombre: \"PALIC\" },\r\n    { id: 5, nombre: \"FUTURO\" }\r\n  ];\r\n  function colorEstado(code) {\r\n    if (code == 'p') {\r\n      return 'badge-secondary';\r\n    }\r\n    if (code == 't') {\r\n      return 'badge-primary';\r\n    }\r\n    if (code == 'r') {\r\n      return 'badge-success';\r\n    }\r\n    if (code == 'a') {\r\n      return 'badge-danger';\r\n    }\r\n  }\r\n\r\n  function cargarMedicos() {\r\n    $axios.get(\"/Medicos/Query?\")\r\n      .then(res => {\r\n        medicos = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarEstados() {\r\n    $axios.get(\"/Citas/Estados\")\r\n      .then(res => {\r\n        estados = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n\r\n  function cargarCitas() {\r\n    filter.medicoID = idMedico;\r\n\r\n    let qs = new URLSearchParams(filter).toString()\r\n    $axios.get(\"/Medicos/CitasFiltrada?\" + qs)\r\n      .then(res => {\r\n        citasPendientes = res.data;\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarDatosPaciente(item) {\r\n    $axios.get(\"/Pacientes/\" + item.pacienteID)\r\n      .then(res => {\r\n        paciente = res.data;\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function buscarDisponibilidadHorario() {\r\n    if (fecha == \"\" || tandaID <= 0) {\r\n      horasDisponibles = [];\r\n      return;\r\n    }\r\n\r\n    let params = \"date=\" + fecha + \"&\" + \"tandiId=\" + tandaID;\r\n    $axios.get(\"/Medicos/HorasDisponibles/\" + idMedico + \"?\" + params)\r\n      .then(res => {\r\n        horasDisponibles = res.data.map(x => {\r\n          return {\r\n            time: x,\r\n            hora: moment(x, \"LT\").format(\"LT\")\r\n          };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        horasDisponibles = [];\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function reprogramarCita(item) {\r\n    cita = item;\r\n    if (fecha == \"\" || tandaID <= 0) {\r\n      fecha = moment().format(\"YYYY-MM-DD\"); // asignando fecha de hoy con un formato especifico\r\n      tandaID = 1;\r\n    }\r\n\r\n    buscarDisponibilidadHorario();\r\n  }\r\n\r\n  function guardarPaciente() {\r\n    if (paciente.aseguradoraID > 0) {\r\n      paciente.nombreAseguradora = aseguradoras.find(e => e.id == paciente.aseguradoraID).nombre;\r\n    }\r\n\r\n    $axios.put(\"/Pacientes/\" + paciente.id, paciente)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Paciente actualizado con exito'\r\n          })\r\n          \r\n          jQuery(\"#modalPaciente\").modal(\"hide\");\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cambiarFechaCita(hora) {\r\n    cita.fecha = fecha + \"T\" + hora;\r\n    cita.estadoID = 1;\r\n    cita.inactivo = false;\r\n\r\n    $axios.put(\"/Citas/\" + cita.id, cita)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Cambio de cita realizado con exito'\r\n          })\r\n          cargarCitas()\r\n          jQuery(\"#modalCrearCita\").modal(\"hide\");\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n\r\n  function irACita(time) {\r\n    $dataCita = {\r\n      fechaCita: fecha,\r\n      tandaID: tandaID,\r\n      hora: time,\r\n      medicoId: idMedico,\r\n      pacienteId: cita.pacienteID\r\n    };\r\n    push('/Cita/Crear');\r\n  }\r\n  \r\n  function btnFiltro() {\r\n    jQuery(\"#filtroAvanzado\").slideToggle(500);\r\n  }\r\n\r\n</script>\r\n\r\n<style>\r\n  .modal-slide-right {\r\n    top: 0;\r\n    bottom: 0;\r\n  }\r\n\r\n  .modal-slide-right .modal-dialog {\r\n    height: 100% !important;\r\n    top: 0;\r\n    position: fixed !important;\r\n  }\r\n\r\n  .modal-slide-right .modal-body {\r\n    height: 100% !important;\r\n    top: 0;\r\n    overflow: auto;\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container mt-3\">\r\n      <div class=\"col-md-12\">\r\n        <div class=\"row\">\r\n\r\n          <div class=\"col-lg-6 mt-2\">\r\n            <input type=\"text\" class=\"form-control\" placeholder=\"Buscar paciente\"\r\n             bind:value={filter.nombrePaciente} on:input={cargarCitas}>\r\n          </div>\r\n          <div class=\"col-lg-4 mt-2\">\r\n            <select class=\"form-control\" id=\"sltMedicos\" style=\"width: 100%\">\r\n              <option value={0} disabled selected>- Seleccionar medico -</option>\r\n              <option value={\"\"}>Todos</option>\r\n              {#each medicos as item}\r\n                <option value={item.id}>{item.name}</option>\r\n              {/each}\r\n            </select>\r\n          </div>\r\n          <div class=\"col-lg-2\">\r\n            <button class=\"btn btn-primary\" id=\"btnFiltro\" on:click={btnFiltro} style=\"margin-top: 8px;\">Filtros</button>\r\n          </div>\r\n          <div id=\"filtroAvanzado\" class=\"col-lg-12 mt-2\" style=\"display: none;\">\r\n              <div class=\"alert alert-secondary\">\r\n                <div class=\"row\">\r\n                  <div class=\"col-lg-6 col-md-6\">\r\n                    <label>Estados</label>\r\n                    <!-- svelte-ignore a11y-no-onchange -->\r\n                    <select class=\"form-control\" bind:value={filter.estadoID} on:change={cargarCitas}>\r\n                      <option value=\"\" disabled selected>- Buscar por estado -</option>\r\n                      <option value={0}>Todos</option>\r\n                      {#each estados as item}\r\n                        <option value={item.id}>{item.nombre}</option>\r\n                      {/each}\r\n                    </select>\r\n                  </div>\r\n                  <div class=\"col-lg-3 col-md-3\">\r\n                    <label>Desde</label>\r\n                    <input type=\"date\" class=\"form-control\" bind:value={filter.fechaInicio} on:input={cargarCitas}>\r\n                  </div>\r\n                  <div class=\"col-lg-3 col-md-3\">\r\n                    <label>Hasta</label>\r\n                    <input type=\"date\" class=\"form-control\" bind:value={filter.fechaFin} on:input={cargarCitas}>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n          </div>\r\n\r\n          <div class=\"col-md-12 mt-2\">\r\n            <div class=\"alert alert-primary\" role=\"alert\">\r\n                \r\n              <h4 class:d-none={citasPendientes.length > 0}>No hay cita</h4>\r\n              <div class=\"table-responsive\">\r\n                {#if citasPendientes.length > 0}\r\n                  <table class=\"table align-td-middle table-card\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Nombre</th>\r\n                        <th>Estado</th>\r\n                        <th>Fecha</th>\r\n                        <th />\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {#each citasPendientes as i}\r\n                        <tr class=\"cursor-table\">\r\n                          <td>{i.nombrePaciente}</td>\r\n                          <td>\r\n                            <span class=\"badge {colorEstado(i.codigoEstado)}\">{i.nombreEstado}</span>\r\n                          </td>\r\n                          <td>{moment(i.fecha).format('LLL')}</td>\r\n                          <td />\r\n                          <td style=\"text-align: right;\">\r\n                            <button\r\n                              class=\"btn btn-success btn-sm mb-1\"\r\n                              data-toggle=\"modal\"\r\n                              data-target=\"#modalPaciente\"\r\n                              on:click={() => cargarDatosPaciente(i)}>\r\n                              <i class=\"mdi mdi-account-search-outline\" />\r\n                              Ver paciente\r\n                            </button>\r\n                            {#if idMedico != \"\"}\r\n                            <button\r\n                              class=\"btn btn-success btn-sm mb-1\"\r\n                              data-toggle=\"modal\"\r\n                              data-target={i.codigoEstado == 'r' ? '#modalNuevaCita' : '#modalCrearCita'}\r\n                              on:click={() => reprogramarCita(i)}>\r\n                              <i class=\"mdi mdi-calendar-remove\" />\r\n                              {i.codigoEstado == 'r' ? 'Crear cita' : 'Reprogramar'}\r\n                            </button>\r\n                            {/if}\r\n                          </td>\r\n                        </tr>\r\n                      {/each}\r\n                    </tbody>\r\n                  </table>\r\n                {/if}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n<form id=\"frmPaciente\" on:submit|preventDefault={guardarPaciente}>\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalPaciente\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalPacienteLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalPacienteLabel\">\r\n          <i class=\"mdi mdi-account-search-outline\" />\r\n          Paciente\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n          <input type=\"hidden\" name=\"IdUser\" value=\"0\" />\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Nombre</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.nombre} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Apellido</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.apellidos} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Cedula</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.cedula} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Telefono</label>\r\n              <input\r\n                type=\"tel\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.telefono} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Correo electronico</label>\r\n              <input\r\n                type=\"email\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.correo}/>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Aseguradora</label>\r\n              <select\r\n                class=\"form-control js-select2\"\r\n                bind:value={paciente.aseguradoraID}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                {#each aseguradoras as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                {/each}\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">No. Seguro</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.noAfiliado} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Pais</label>\r\n              <select class=\"form-control js-select2\" bind:value={paciente.nacionalidad}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                <option value={\"Rep. Dom.\"}>Rep. Dom.</option>\r\n                <option value={\"Haiti\"}>Haiti</option>\r\n                <option value={\"Venezuela\"}>Venezuela</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Provincia</label>\r\n              <select\r\n                class=\"form-control js-select2\"\r\n                bind:value={paciente.provinciaID}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                {#each provincias as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                {/each}\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Direccion</label>\r\n              <textarea\r\n                class=\"form-control\"\r\n                rows=\"2\"\r\n                bind:value={paciente.direccion} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Observaciones</label>\r\n              <textarea\r\n                class=\"form-control\"\r\n                rows=\"3\"\r\n                bind:value={paciente.observaciones} />\r\n            </div>\r\n          </div>\r\n\r\n          <br />\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-outline-danger\"\r\n            data-dismiss=\"modal\">\r\n            Cerrar\r\n          </button>\r\n          <button type=\"submit\" class=\"btn btn-outline-primary\">\r\n            Guardar\r\n            <i class=\"mdi mdi-content-save-outline\" />\r\n          </button>\r\n        </div>\r\n        \r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalCrearCita\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalCrearCitaLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalCrearCitaLabel\">\r\n          <i class=\"mdi mdi-calendar-plus\" />\r\n          Reprogramacion de cita\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\" style=\"height: 100%; top: 0; overflow: auto;\">\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group\">\r\n              <label for=\"inputAddress\">Fecha</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control form-control-sm\"\r\n                bind:value={fecha}\r\n                on:change={buscarDisponibilidadHorario} />\r\n            </div>\r\n          </div>\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group \">\r\n              <label class=\"font-secondary\">Tanda</label>\r\n              <!-- svelte-ignore a11y-no-onchange -->\r\n              <select\r\n                class=\"form-control form-control-sm js-select2\"\r\n                bind:value={tandaID}\r\n                on:change={buscarDisponibilidadHorario}>\r\n                <option value={0} disabled>- Seleccionar -</option>\r\n                <option value={1}>Matutina</option>\r\n                <option value={2}>Vespertina</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"list-group list\">\r\n          {#if horasDisponibles.length <= 0}\r\n            <div class=\"alert alert-success\" role=\"alert\">\r\n              No hay disponibilidad en este horario\r\n            </div>\r\n          {/if}\r\n          {#each horasDisponibles as i}\r\n            <div\r\n              class=\"list-group-item d-flex align-items-center svelte-1nu1nbu\">\r\n              <div class=\"\">\r\n                <div class=\"name\">{i.hora}</div>\r\n              </div>\r\n              <div class=\"ml-auto\">\r\n                <button\r\n                  on:click={cambiarFechaCita(i.time)}\r\n                  class=\"btn btn-outline-success btn-sm\">\r\n                  Seleccionar\r\n                </button>\r\n              </div>\r\n            </div>\r\n          {/each}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalNuevaCita\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalNuevaCitaLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalNuevaCitaLabel\">\r\n          <i class=\"mdi mdi-calendar-plus\" />\r\n          Creacion de cita\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\" style=\"height: 100%; top: 0; overflow: auto;\">\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group\">\r\n              <label for=\"inputAddress\">Fecha</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control form-control-sm\"\r\n                bind:value={fecha}\r\n                on:change={buscarDisponibilidadHorario} />\r\n            </div>\r\n          </div>\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group \">\r\n              <label class=\"font-secondary\">Tanda</label>\r\n              <!-- svelte-ignore a11y-no-onchange -->\r\n              <select\r\n                class=\"form-control form-control-sm js-select2\"\r\n                bind:value={tandaID}\r\n                on:change={buscarDisponibilidadHorario}>\r\n                <option value={0} disabled>- Seleccionar -</option>\r\n                <option value={1}>Matutina</option>\r\n                <option value={2}>Vespertina</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"list-group list\">\r\n          {#if horasDisponibles.length <= 0}\r\n            <div class=\"alert alert-success\" role=\"alert\">\r\n              No hay disponibilidad en este horario\r\n            </div>\r\n          {/if}\r\n          {#each horasDisponibles as i}\r\n            <div\r\n              class=\"list-group-item d-flex align-items-center svelte-1nu1nbu\">\r\n              <div class=\"\">\r\n                <div class=\"name\">{i.hora}</div>\r\n              </div>\r\n              <div class=\"ml-auto\">\r\n                <button\r\n                  on:click={() => irACita(i.time)}\r\n                  class=\"btn btn-outline-success btn-sm\">\r\n                  Seleccionar\r\n                </button>\r\n              </div>\r\n            </div>\r\n          {/each}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { UserManager } from \"../../util.js\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import { session, activePage, host, dataCita, connection, axios, errorConexion, toast } \r\n    from \"../../store\";\r\n  import { onMount } from \"svelte\";\r\n  import moment from \"moment\";\r\n  import Swal from 'sweetalert2';\r\n\r\n  let user = {};\r\n  user = new UserManager($session.authorizationHeader.Authorization)\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n  $activePage = \"asistente.index\";\r\n\r\n  let busqueda = \"\";\r\n  let medicos = [];\r\n  let citasPendientes = [];\r\n  let citasEnTurno = [];\r\n  let citasRealizadas = [];\r\n\r\n  let horasDisponibles = [];\r\n  let provincias = [\r\n    { id: 1, nombre: \"Duarte\" },\r\n    { id: 2, nombre: \"Santiago\" },\r\n    { id: 3, nombre: \"Distrito Nacional\" }\r\n  ];\r\n  let aseguradoras = [\r\n    { id: 1, nombre: \"SENASA\" },\r\n    { id: 2, nombre: \"HUMANO SEGURO\" },\r\n    { id: 3, nombre: \"RENACER\" },\r\n    { id: 4, nombre: \"PALIC\" },\r\n    { id: 5, nombre: \"FUTURO\" }\r\n  ];\r\n  let idMedico = \"\";\r\n  let pacienteEnviado = \"\";\r\n  let fecha = \"\";\r\n  let tandaID = 0;\r\n\r\n  let paciente = {\r\n    id: \"\",\r\n    nombre: \"\",\r\n    apellido: \"\",\r\n    cedula: \"\",\r\n    correo: \"\",\r\n    telefono: \"\",\r\n    aseguradoraID: 0,\r\n    nombreAseguradora: \"\",\r\n    provinciaID: 0,\r\n    nacionalidad: \"\",\r\n    noAfiliado: \"\",\r\n    sexo: \"\",\r\n    direccion: \"\",\r\n    observaciones: \"\"\r\n  };\r\n  let cita = {\r\n    id: 0,\r\n    medicoID: \"\",\r\n    pacienteID: \"\",\r\n    aseguradoraID: 0,\r\n    estadoID: 1,\r\n    fecha: \"\",\r\n    observaciones: \"\",\r\n    inactivo: false,\r\n  };\r\n\r\n  onMount(() => {\r\n    jQuery(\"#sltMedicos\").select2();\r\n    jQuery(\"#sltMedicos\").on(\"select2:select\", e => {\r\n      let data = e.params.data;\r\n      idMedico = data.id.split('=')[0];\r\n      \r\n      cargarPacienteEnviado();\r\n      cargarCitas();\r\n      cargarCitasRealizadas();\r\n    });\r\n\r\n    cargarMedicos();\r\n  });\r\n\r\n  $connection.on(\"RecibirAvisoDelPaciente\", (data, paciente) => {\r\n    if ($activePage == \"asistente.index\") {\r\n      if (citasEnTurno.length > 0) {\r\n        pacienteEnviado = paciente\r\n\r\n        if (pacienteEnviado == \"\") {\r\n          cargarCitas();\r\n          cargarCitasRealizadas();\r\n        }\r\n      }\r\n\r\n      if (paciente == \"\") {\r\n        Swal.fire({\r\n          title: 'Aviso',\r\n          text: 'El paciente ya fue atendido, favor de mandar otro',\r\n          icon: 'success'\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  function cargarMedicos() {\r\n    $axios.get(\"/MedicosAsistentes/\" + user.nameid + \"/Medicos\")\r\n      .then(res => {\r\n        medicos = res.data;\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion();\r\n      });\r\n  }\r\n  function cargarCitas() {\r\n    $axios.get(\"/Medicos/Citas/\" + idMedico)\r\n      .then(res => {\r\n        let array = res.data.filter (e =>\r\n            moment(e.fecha).format(\"YYYY-MM-DD\") ==\r\n            moment().format(\"YYYY-MM-DD\")\r\n        );\r\n\r\n        citasPendientes = array.filter(e => e.estadoID == 1);\r\n        citasEnTurno = array.filter(e => e.estadoID == 2);\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarCitasRealizadas() {\r\n    $axios.get(\"/Medicos/CitasRealizadas/\" + idMedico)\r\n      .then(res => {\r\n        citasRealizadas = res.data.filter (e =>\r\n            moment(e.fecha).format(\"YYYY-MM-DD\") ==\r\n            moment().format(\"YYYY-MM-DD\")\r\n        );\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function buscarDisponibilidadHorario() {\r\n    if (fecha == \"\" || tandaID <= 0) {\r\n      horasDisponibles = [];\r\n      return;\r\n    }\r\n\r\n    let params = \"date=\" + fecha + \"&\" + \"tandiId=\" + tandaID;\r\n    $axios.get(\"/Medicos/HorasDisponibles/\" + idMedico + \"?\" + params)\r\n      .then(res => {\r\n        horasDisponibles = res.data.map(x => {\r\n          return {\r\n            time: x,\r\n            hora: moment(x, \"LT\").format(\"LT\")\r\n          };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        horasDisponibles = [];\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarDatosPaciente(item) {\r\n    cita = item;\r\n    $axios.get(\"/Pacientes/\" + item.pacienteID)\r\n      .then(res => {\r\n        paciente = res.data;\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function reprogramarCita(item) {\r\n    cita = item;\r\n    if (fecha == \"\" || tandaID <= 0) {\r\n      fecha = moment().format(\"YYYY-MM-DD\");\r\n      tandaID = 1;\r\n    }\r\n\r\n    buscarDisponibilidadHorario();\r\n  }\r\n  function guardarPaciente() {\r\n    if (paciente.aseguradoraID > 0) {\r\n      paciente.nombreAseguradora = aseguradoras.find(e => e.id == paciente.aseguradoraID).nombre;\r\n    }\r\n\r\n    $axios.put(\"/Pacientes/\" + paciente.id, paciente)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          Swal.fire({\r\n            title: 'Actualizado',\r\n            text: 'Paciente actualizado con exito',\r\n            icon: 'success'\r\n          });\r\n\r\n          jQuery(\"#modalPaciente\").modal(\"hide\");\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function guardarYEnviarPaciente() {\r\n    if (paciente.aseguradoraID > 0) {\r\n      paciente.nombreAseguradora = aseguradoras.find(e => e.id == paciente.aseguradoraID).nombre;\r\n    }\r\n\r\n    $axios.put(\"/Pacientes/\" + paciente.id, paciente)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          pacienteEnviado = paciente.id;\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Se ha enviado correctamente'\r\n          })\r\n          jQuery(\"#modalPaciente\").modal(\"hide\");\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cambiarFechaCita(hora) {\r\n    cita.fecha = fecha + \"T\" + hora;\r\n    cita.estadoID = 1;\r\n\r\n    $axios.put(\"/Citas/\" + cita.id, cita)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Cambio de cita realizado con exito'\r\n          })\r\n          jQuery(\"#modalCrearCita\").modal(\"hide\");\r\n          cargarCitas()\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cambiarEstadoCita(item) {\r\n    item.estadoID = 2;\r\n    $axios.put(\"/Citas/\" + item.id, item)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          cargarCitas();\r\n          $connection.invoke(\"EnviarPaciente\", item.medicoID, item.pacienteID, \"encolar\")\r\n          .catch(err => console.error(err));\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function anularCita() {\r\n    Swal.fire({\r\n      title: 'Estas seguro que deseas anular la cita?',\r\n      text: \"Este cambio no se puede deshacer!\",\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n      cancelButtonText: 'No',\r\n      confirmButtonText: 'Si'\r\n    }).then((result) => {\r\n      if (result.isConfirmed) {\r\n        cita.inactivo = true;\r\n        cita.estadoID = 4;\r\n        $axios.put(\"/Citas/\" + cita.id, cita)\r\n          .then(res => {\r\n            if (res.data.success) {\r\n              $toast(5000).fire({\r\n                title: 'Cita anulada con exito',\r\n                icon: 'success'\r\n              });\r\n              cargarCitas();\r\n              jQuery(\"#modalCrearCita\").modal(\"hide\");\r\n            }\r\n          })\r\n          .catch(err => {\r\n            console.error(err);\r\n            $errorConexion()\r\n          });\r\n      }\r\n    })\r\n  }\r\n  function irACita(time) {\r\n    let cita = medicos.find(x => x.medicoID == idMedico);\r\n\r\n    $dataCita = {\r\n      fechaCita: fecha,\r\n      tandaID: tandaID,\r\n      hora: time,\r\n      medicoId: idMedico,\r\n      pacienteId: cita.pacienteID,\r\n      ubicacion: cita.ubicacion\r\n    };\r\n    push('/Cita/Crear');\r\n  }\r\n\r\n  function cargarPacienteEnviado() {\r\n    $axios.get(\"/Medicos/\" + idMedico + \"/PacientePendiente\")\r\n      .then(res => {\r\n        pacienteEnviado = res.data.data || \"\";\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion();\r\n      });\r\n  }\r\n\r\n  function enviarPaciente() {\r\n    $axios.post(\"/Medicos/\" + cita.medicoID + \"/AsignarPaciente?pacienteId=\" + cita.pacienteID)\r\n    .then(res => {\r\n      if (!res.data.errors) {\r\n        $connection.invoke(\"EnviarPaciente\", cita.medicoID, cita.pacienteID, \"asignar\")\r\n          .catch(err => console.error(err));\r\n        guardarYEnviarPaciente()\r\n      } else {\r\n        $toast(5000).fire({\r\n          icon: 'error',\r\n          title: 'Error de conexion'\r\n        })\r\n      }\r\n\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    });\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .cursor-table {\r\n    cursor: pointer;\r\n  }\r\n\r\n  .cursor-table td {\r\n    padding: 20px;\r\n  }\r\n\r\n  .modal-slide-right {\r\n    top: 0;\r\n    bottom: 0;\r\n  }\r\n\r\n  .modal-slide-right .modal-dialog {\r\n    height: 100% !important;\r\n    top: 0;\r\n    position: fixed !important;\r\n  }\r\n\r\n  .modal-slide-right .modal-body {\r\n    height: 100% !important;\r\n    top: 0;\r\n    overflow: auto;\r\n  }\r\n  tbody tr.active-turno{\r\n    -webkit-box-shadow: 0px 0px 0px 3px #0c9;\r\n-moz-box-shadow: 0px 0px 0px 3px#0c9;\r\nbox-shadow: 0px 0px 0px 3px #0c9;\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container mt-3\">\r\n      <div class=\"mt-4 col-md-12\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-5\">\r\n            <div class=\"input-group input-group-flush mb-3\">\r\n              <input\r\n                type=\"search\"\r\n                class=\"form-control form-control-appended\"\r\n                data-bind=\"textInput: busqueda\"\r\n                placeholder=\"Buscar\"\r\n                bind:value={busqueda} />\r\n              <div class=\"input-group-append\">\r\n                <div class=\"input-group-text\">\r\n                  <span class=\"mdi mdi-magnify\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-lg-4\">\r\n            <select class=\"form-control\" id=\"sltMedicos\" style=\"width: 100%\">\r\n              <option value={0} disabled selected>- Seleccionar -</option>\r\n              {#each medicos as item}\r\n                <option value={item.medicoID + \"=\" + item.userName}>{item.name}</option>\r\n              {/each}\r\n            </select>\r\n          </div>\r\n\r\n          <a href=\"#/Cita/Crear\" class=\"btn m-b-30 ml-2 mr-2 ml-3 btn-primary\">\r\n            <i class=\"mdi mdi-plus\" />\r\n            Nueva cita\r\n          </a>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-md-12 m-b-30\">\r\n\r\n        <div class=\"alert alert-success\" role=\"alert\">\r\n          <h4 class=\"alert-heading\">Consultas en turno</h4>\r\n          <div class=\"table-responsive\">\r\n            <h4 class:d-none={citasEnTurno.length > 0}>No hay cita</h4>\r\n            {#if citasEnTurno.length > 0}\r\n              <table class=\"table align-td-middle table-card\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Nombre</th>\r\n                    <th>Celular</th>\r\n                    <th>Observacion</th>\r\n                    <th />\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {#each citasEnTurno as i}\r\n                    <tr class:active-turno={pacienteEnviado == i.pacienteID}>\r\n                      <td>\r\n                       {i.nombrePaciente}\r\n                      </td>\r\n                      <td />\r\n                      <td>{i.observaciones}</td>\r\n                      <td style=\"text-align: right;\">\r\n                        <button\r\n                          class=\"btn btn-success btn-sm mb-1\"\r\n                          data-toggle=\"modal\"\r\n                          data-target=\"#modalPaciente\"\r\n                          on:click={() => cargarDatosPaciente(i)}>\r\n                          <i class=\"mdi mdi-account-search-outline\" />\r\n                          Ver paciente\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  {/each}\r\n                </tbody>\r\n              </table>\r\n            {/if}\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"alert alert-primary\" role=\"alert\">\r\n          <h4 class=\"alert-heading\">Consultas pendientes</h4>\r\n          <h4 class:d-none={citasPendientes.length > 0}>No hay cita</h4>\r\n          <div class=\"table-responsive\">\r\n            {#if citasPendientes.length > 0}\r\n              <table class=\"table align-td-middle table-card\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Nombre</th>\r\n                    <th>Celular</th>\r\n                    <th>Observacion</th>\r\n                    <th />\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {#each citasPendientes as i}\r\n                    <tr class=\"cursor-table\">\r\n                      <td>{i.nombrePaciente}</td>\r\n                      <td />\r\n                      <td>{i.observaciones}</td>\r\n                      <td />\r\n                      <td style=\"text-align: right;\">\r\n                        <button\r\n                          class=\"btn btn-success btn-sm mb-1\"\r\n                          data-toggle=\"modal\"\r\n                          data-target=\"#modalPaciente\"\r\n                          on:click={() => cargarDatosPaciente(i)}>\r\n                          <i class=\"mdi mdi-account-search-outline\" />\r\n                          Ver paciente\r\n                        </button>\r\n                        <button\r\n                          class=\"btn btn-success btn-sm mb-1\"\r\n                          data-toggle=\"modal\"\r\n                          data-target=\"#modalCrearCita\"\r\n                          on:click={() => reprogramarCita(i)}>\r\n                          <i class=\"mdi mdi-calendar-remove\" />\r\n                          Reprogramar\r\n                        </button>\r\n                        <button\r\n                          class=\"btn btn-primary btn-sm mb-1\"\r\n                          title=\"Poner en cola\"\r\n                          on:click={() => cambiarEstadoCita(i)}>\r\n                          <i class=\"mdi mdi-ticket-confirmation\" />\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  {/each}\r\n                </tbody>\r\n              </table>\r\n            {/if}\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"alert alert-secondary\" role=\"alert\">\r\n          <h4 class=\"alert-heading\">Consultas realizadas</h4>\r\n          <h4 class:d-none={citasRealizadas.length > 0}>No hay cita</h4>\r\n          <div class=\"table-responsive\">\r\n            {#if citasRealizadas.length > 0}\r\n              <table class=\"table align-td-middle table-card\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Nombre</th>\r\n                    <th>Celular</th>\r\n                    <th>Observacion</th>\r\n                    <th />\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {#each citasRealizadas as i}\r\n                    <tr class=\"cursor-table\">\r\n                      <td>{i.nombrePaciente}</td>\r\n                      <td />\r\n                      <td>{i.observaciones}</td>\r\n                      <td />\r\n                      <td style=\"text-align: right;\">\r\n                        <button\r\n                          class=\"btn btn-success btn-sm mb-1\"\r\n                          data-toggle=\"modal\"\r\n                          data-target=\"#modalPaciente\"\r\n                          on:click={() => cargarDatosPaciente(i)}>\r\n                          <i class=\"mdi mdi-account-search-outline\" />\r\n                          Ver paciente\r\n                        </button>\r\n                        <button\r\n                          class=\"btn btn-success btn-sm mb-1\"\r\n                          data-toggle=\"modal\"\r\n                          data-target=\"#modalNuevaCita\"\r\n                          on:click={() => reprogramarCita(i)}>\r\n                          <i class=\"mdi mdi-calendar-remove\" />\r\n                          Crear cita\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  {/each}\r\n                </tbody>\r\n              </table>\r\n            {/if}\r\n\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalPaciente\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalPacienteLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalPacienteLabel\">\r\n          <i class=\"mdi mdi-account-search-outline\" />\r\n          Paciente\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <form id=\"frmPaciente\" on:submit|preventDefault={guardarPaciente}>\r\n          <input type=\"hidden\" name=\"IdUser\" value=\"0\" />\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Nombre</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.nombre} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Apellido</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.apellidos} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Cedula</label>\r\n              <input\r\n                type=\"name\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.cedula} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Telefono</label>\r\n              <input\r\n                type=\"tel\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                required\r\n                bind:value={paciente.telefono} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Correo electronico</label>\r\n              <input\r\n                type=\"email\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.correo}/>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Aseguradora</label>\r\n              <select\r\n                class=\"form-control js-select2\"\r\n                bind:value={paciente.aseguradoraID}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                {#each aseguradoras as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                {/each}\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">No. Seguro</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                name=\"Name\"\r\n                maxlength=\"200\"\r\n                bind:value={paciente.noAfiliado} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Pais</label>\r\n              <select class=\"form-control js-select2\" bind:value={paciente.nacionalidad}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                <option value={\"Rep. Dom.\"}>Rep. Dom.</option>\r\n                <option value={\"Haiti\"}>Haiti</option>\r\n                <option value={\"Venezuela\"}>Venezuela</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Provincia</label>\r\n              <select\r\n                class=\"form-control js-select2\"\r\n                bind:value={paciente.provinciaID}>\r\n                <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                {#each provincias as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                {/each}\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Direccion</label>\r\n              <textarea\r\n                class=\"form-control\"\r\n                rows=\"2\"\r\n                bind:value={paciente.direccion} />\r\n            </div>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <div class=\"form-group col-md-12\">\r\n              <label for=\"\">Observaciones</label>\r\n              <textarea\r\n                class=\"form-control\"\r\n                rows=\"3\"\r\n                bind:value={paciente.observaciones} />\r\n            </div>\r\n          </div>\r\n\r\n          <br />\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-outline-danger\"\r\n              data-dismiss=\"modal\">\r\n              Cerrar\r\n            </button>\r\n            <button type=\"submit\" class=\"btn btn-outline-primary\">\r\n              Guardar\r\n              <i class=\"mdi mdi-content-save-outline\" />\r\n            </button>\r\n            {#if cita.estadoID == 2}\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-success\"\r\n              title=\"Guardar y enviar\"\r\n              on:click={enviarPaciente}>\r\n              Enviar paciente\r\n              <i class=\"mdi mdi-send\" />\r\n            </button>\r\n            {/if}\r\n          </div>\r\n        </form>\r\n      </div>\r\n      \r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalCrearCita\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalCrearCitaLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalCrearCitaLabel\">\r\n          <i class=\"mdi mdi-calendar-plus\" />\r\n          Reprogramacion de cita\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\" style=\"height: 100%; top: 0; overflow: auto;\">\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group\">\r\n              <label for=\"inputAddress\">Fecha</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control form-control-sm\"\r\n                bind:value={fecha}\r\n                on:change={buscarDisponibilidadHorario} />\r\n            </div>\r\n          </div>\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group \">\r\n              <label class=\"font-secondary\">Tanda</label>\r\n              <!-- svelte-ignore a11y-no-onchange -->\r\n              <select\r\n                class=\"form-control form-control-sm js-select2\"\r\n                bind:value={tandaID}\r\n                on:change={buscarDisponibilidadHorario}>\r\n                <option value={0} disabled>- Seleccionar -</option>\r\n                <option value={1}>Matutina</option>\r\n                <option value={2}>Vespertina</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"list-group list\">\r\n          {#if horasDisponibles.length <= 0}\r\n            <div class=\"alert alert-success\" role=\"alert\">\r\n              No hay disponibilidad en este horario\r\n            </div>\r\n          {/if}\r\n          {#each horasDisponibles as i}\r\n            <div\r\n              class=\"list-group-item d-flex align-items-center svelte-1nu1nbu\">\r\n              <div class=\"\">\r\n                <div class=\"name\">{i.hora}</div>\r\n              </div>\r\n              <div class=\"ml-auto\">\r\n                <button\r\n                  on:click={cambiarFechaCita(i.time)}\r\n                  class=\"btn btn-outline-success btn-sm\">\r\n                  Seleccionar\r\n                </button>\r\n              </div>\r\n            </div>\r\n          {/each}\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"modal-footer\" class:d-none={cita.estadoID == 3}>\r\n        <button on:click={anularCita}\r\n          type=\"button\" class=\"btn btn-danger\">\r\n          Anular cita\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalNuevaCita\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalNuevaCitaLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalNuevaCitaLabel\">\r\n          <i class=\"mdi mdi-calendar-plus\" />\r\n          Creacion de cita\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\" style=\"height: 100%; top: 0; overflow: auto;\">\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group\">\r\n              <label for=\"inputAddress\">Fecha</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control form-control-sm\"\r\n                bind:value={fecha}\r\n                on:change={buscarDisponibilidadHorario} />\r\n            </div>\r\n          </div>\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group \">\r\n              <label class=\"font-secondary\">Tanda</label>\r\n              <!-- svelte-ignore a11y-no-onchange -->\r\n              <select\r\n                class=\"form-control form-control-sm js-select2\"\r\n                bind:value={tandaID}\r\n                on:change={buscarDisponibilidadHorario}>\r\n                <option value={0} disabled>- Seleccionar -</option>\r\n                <option value={1}>Matutina</option>\r\n                <option value={2}>Vespertina</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"list-group list\">\r\n          {#if horasDisponibles.length <= 0}\r\n            <div class=\"alert alert-success\" role=\"alert\">\r\n              No hay disponibilidad en este horario\r\n            </div>\r\n          {/if}\r\n          {#each horasDisponibles as i}\r\n            <div\r\n              class=\"list-group-item d-flex align-items-center svelte-1nu1nbu\">\r\n              <div class=\"\">\r\n                <div class=\"name\">{i.hora}</div>\r\n              </div>\r\n              <div class=\"ml-auto\">\r\n                <button\r\n                  on:click={() => irACita(i.time)}\r\n                  class=\"btn btn-outline-success btn-sm\">\r\n                  Seleccionar\r\n                </button>\r\n              </div>\r\n            </div>\r\n          {/each}\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"modal-footer\" class:d-none={cita.estadoID == 3}>\r\n        <button on:click={anularCita}\r\n          type=\"button\" class=\"btn btn-danger\">\r\n          Anular cita\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import { activePage, dataCita, axios, session, errorConexion, toast } from \"../../store\";\r\n  import { onMount } from \"svelte\";\r\n  import moment from 'moment';\r\n  import Swal from 'sweetalert2';\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n\r\n  $activePage = \"citas.crear\";\r\n\r\n  onMount(() => {\r\n    jQuery(\"#sltMedicos\").select2();\r\n    jQuery(\"#sltMedicos\").on(\"select2:select\", e => {\r\n      let data = e.params.data;\r\n      obj.MedicoID = data.id;\r\n      cargarHoras();\r\n    });\r\n\r\n    cargarPacientes();\r\n    cargarTandas();\r\n    cargarHoras();\r\n    cargarMedicos();\r\n  });\r\n\r\n  let data = $dataCita;\r\n  let obj = {\r\n    Observaciones: \"\",\r\n    Fecha: data.fechaCita || \"\",\r\n    MedicoID: data.medicoId,\r\n    PacienteID: data.pacienteId || \"\",\r\n    AseguradoraID: 1,\r\n    EstadoID: 1,\r\n    Nombre: \"\",\r\n    Apellidos: \"\",\r\n    Telefono: \"\",\r\n    Correo: \"\",\r\n    Sexo: '',\r\n    Direccion: \"\",\r\n    tandaID: data.tandaID,\r\n    hora: \"\"\r\n  };\r\n  let tandas = [];\r\n  let horas = [];\r\n  let pacientes = [];\r\n  let medicos = [];\r\n  $: faltaLaTanda = obj.tandaID == 0 || obj.tandaID == undefined;\r\n  let busquedaPacientes = \"\";\r\n\r\n  function cargarMedicos() {\r\n    $axios.get(\"/Medicos/Query\")\r\n    .then(res => {\r\n        medicos = res.data;\r\n        setTimeout(x => jQuery(\"#sltMedicos\").val(obj.MedicoID).trigger('change'), 10);\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarPacientes() {\r\n    let qs = busquedaPacientes != \"\" ? \"?keyword=\" + busquedaPacientes : \"\";\r\n    $axios.get(\"/Pacientes/Query\" + qs)\r\n    .then(res => {\r\n        pacientes = res.data;\r\n\r\n        if (obj.PacienteID != \"\") {\r\n          let select = pacientes.find(x => x.id == obj.PacienteID)\r\n          seleccionarPaciente(select)\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarTandas() {\r\n    $axios.get(\"/Tandas/GetAll\")\r\n    .then(res => {\r\n        tandas = res.data;\r\n        obj.tandaID = $dataCita.tandaID || 0;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarHoras() {\r\n    let params = \"?date=\" + obj.Fecha + \"&\" + \"tandiID=\" + obj.tandaID;\r\n\r\n    if (obj.Fecha == \"\" || obj.tandaID <= 0 || obj.MedicoID == \"\" || obj.MedicoID == 0) {\r\n      horas = [];\r\n      return;  \r\n    }\r\n\r\n    $axios.get(\"/Medicos/HorasDisponibles/\" + obj.MedicoID + params)\r\n    .then(res => {\r\n      horas = res.data.map(x => {\r\n        return {\r\n          time: x,\r\n          hora: moment(x, 'LT').format('LT')\r\n        }\r\n      });\r\n      obj.hora = $dataCita.hora || \"\";\r\n    }).catch(err => {\r\n      horas = [];\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n\r\n  function seleccionarPaciente(item) {\r\n    obj.PacienteID = item.id;\r\n    obj.Nombre = item.nombre;\r\n    obj.Apellidos = item.apellidos;\r\n    obj.Telefono = item.telefono;\r\n    obj.Direccion = item.direccion;\r\n    \r\n    jQuery('#modalPacientes').modal('hide');\r\n  }\r\n\r\n  function guardarPaciente() {\r\n    let method = ''\r\n\r\n    if (obj.PacienteID == \"\") {\r\n      $axios.post(\"/Pacientes\", obj)\r\n      .then(res => {\r\n        obj.PacienteID = res.data.data;\r\n        crearCita();\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      })\r\n    } else {\r\n      $axios.put(\"/Pacientes/\" + obj.PacienteID, obj)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          obj.PacienteID = res.data.data;\r\n          crearCita();\r\n        } else {\r\n          console.log(res);\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      })\r\n    }\r\n  }\r\n\r\n  function crearCita() {\r\n    obj.Fecha = obj.Fecha + \"T\" + obj.hora;\r\n\r\n    $axios.post(\"/Citas\", obj)\r\n    .then(res => {\r\n      if (res.data.success) {\r\n        $dataCita = {};\r\n        $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'La cita fue creada con exito'\r\n          })\r\n        push('/Cita/Gestionar');\r\n      } else {\r\n        console.log(res);\r\n        Swal.fire({\r\n          title: 'Error',\r\n          text: 'Ocurrio un error al crear la cita, intente de nuevo',\r\n          icon: 'error'\r\n        });\r\n      }\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .modal-slide-right .modal-body {\r\n    height: 100% !important;\r\n    top: 0;\r\n    overflow: auto;\r\n  }\r\n\r\n  .list-group-item:nth-child(2n+1) {\r\n    background-color: #3e46760c;\r\n  }\r\n\r\n  .list-group-item {\r\n    border-top: none;\r\n    border-left: none;\r\n    border-right: none;\r\n    background-color: transparent;\r\n    border-radius: 0 !important;\r\n  }\r\n\r\n  .link-pacientes {\r\n    width: 100%;\r\n    border-radius: 5px;\r\n  }\r\n\r\n  .link-pacientes:hover {\r\n    background-color: rgba(241, 241, 241, 0.247);\r\n  }\r\n  .borde-derecho {\r\n    border-right: 1px solid rgb(236, 236, 236);\r\n  }\r\n  .nombre-apellido{\r\n    text-transform:capitalize !important\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container mt-3\">\r\n      <div class=\"row\">\r\n        <div class=\"col-lg-12 mb-5\">\r\n          <div class=\"card\">\r\n            <div class=\"card-header\">\r\n              <h5>\r\n                <i class=\"mdi mdi-checkbox-intermediate\" />\r\n                Creando cita\r\n              </h5>\r\n              <div class=\"card-controls\"></div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <form class=\"row\" on:submit|preventDefault={guardarPaciente}>\r\n                <div class=\"col-lg-5 borde-derecho\">\r\n                  <div class=\"col-lg-12 mt-2\" style=\"padding: 0; margin: 0;\">\r\n                      <button class=\"btn btn-primary btn-sm\" data-toggle=\"modal\" style=\"position: absolute; top: -30px; right: 0;\" data-target=\"#modalPacientes\" type=\"button\">\r\n                    <i class=\"mdi mdi-search-web\" />\r\n                    Buscar paciente\r\n                  </button>\r\n                  </div>\r\n\r\n                  <div class=\"form-group\">\r\n                    <label for=\"inpNombre\">Nombre paciente <span class=\"text-danger\">*</span> </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      class=\"form-control\"\r\n                      id=\"inpNombre\"\r\n                      bind:value={obj.Nombre} required />\r\n                  </div>\r\n                  <div class=\"form-group\">\r\n                    <label for=\"inpApellido\">Apellidos paciente <span class=\"text-danger\">*</span></label>\r\n                    <input\r\n                      type=\"text\"\r\n                      class=\"form-control\"\r\n                      id=\"inpApellido\"\r\n                      bind:value={obj.Apellidos} required />\r\n                  </div>\r\n                  <div class=\"form-group\">\r\n                    <label for=\"inpTelefono\">Telefono / Celular <span class=\"text-danger\">*</span></label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      class=\"form-control\"\r\n                      id=\"inpTelefono\"\r\n                      bind:value={obj.Telefono} required />\r\n                  </div>\r\n                  <div class=\"form-group\">\r\n                    <label for=\"inpCorreo\">Correo electronico</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      class=\"form-control\"\r\n                      id=\"inpCorreo\"\r\n                      bind:value={obj.Correo} />\r\n                  </div>\r\n                  <!-- <div class=\"form-group\">\r\n                    <label for=\"\">Sexo</label>\r\n                      <div class=\"m-b-10\">\r\n                        <label class=\"cstm-switch \">\r\n                          <input type=\"radio\" name=\"radioSexo\" class=\"cstm-switch-input\" \r\n                            value={'M'} bind:group={obj.Sexo} required>\r\n                            <span class=\"cstm-switch-indicator\"></span>\r\n                            <span class=\"cstm-switch-description\">Masculino</span>\r\n                        </label>\r\n                        <label class=\"cstm-switch m-l-10 \">\r\n                            <input type=\"radio\" name=\"radioSexo\" class=\"cstm-switch-input\"\r\n                            value={'F'} bind:group={obj.Sexo} required>\r\n                            <span class=\"cstm-switch-indicator\"></span>\r\n                            <span class=\"cstm-switch-description\">Femenino</span>\r\n                        </label>\r\n                      </div>\r\n                  </div> -->\r\n\r\n                  <div class=\"form-group \">\r\n                    <label class=\"font-secondary\">Direccion</label>\r\n                    <textarea\r\n                      class=\"form-control\"\r\n                      rows=\"3\"\r\n                      bind:value={obj.Direccion} />\r\n                  </div>\r\n                  <p>Los campos con un ( <span class=\"text-danger\">*</span> ) son obligatorios</p>\r\n\r\n                </div>\r\n                <div class=\"col-lg-7\">\r\n                  <div class=\"row\">\r\n                    <div class=\"col-lg-6\">\r\n                      <div class=\"form-group\">\r\n                        <label for=\"Fecha\">Fecha cita</label>\r\n                        <input\r\n                          type=\"date\"\r\n                          class=\"form-control mb-2\"\r\n                          id=\"Fecha\"\r\n                          bind:value={obj.Fecha} on:change={() => {\r\n                            cargarHoras();\r\n                          }} required/>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-lg-6\">\r\n                      <div class=\"form-group \">\r\n                        <label class=\"font-secondary\">Tanda</label>\r\n                        <select class=\"form-control\"\r\n                          bind:value={obj.tandaID} on:change={cargarHoras} required>\r\n                          <option value={0} disabled selected>- Seleccionar -</option>\r\n                          {#each tandas as item}\r\n                          <option value={item.id}>{item.nombre}</option>\r\n                          {/each}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"col-lg-6\">\r\n                      <div class=\"form-group \">\r\n                        <label class=\"font-secondary\">Médico</label>\r\n                        <select class=\"form-control js-select2\" id=\"sltMedicos\" \r\n                            disabled={faltaLaTanda} bind:value={obj.MedicoID} required>\r\n                          <option value={0} disabled selected>- Seleccionar -</option>\r\n                          {#each medicos as item}\r\n                          <option value={item.id}>{item.name}</option>\r\n                          {/each}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-lg-6\">\r\n                      <div class=\"form-group\">\r\n                        <label class=\"font-secondary\">Hora</label>\r\n                        <select class=\"form-control\" bind:value={obj.hora}\r\n                          disabled={faltaLaTanda} required>\r\n                          <option value={\"\"} disabled selected>- Seleccionar -</option>\r\n                          {#each horas as item}\r\n                          <option value={item.time}>{item.hora}</option>\r\n                          {/each}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-lg-12\">\r\n                      <div class=\"form-group \">\r\n                        <label class=\"font-secondary\">Ubicaci&oacute;n del M&eacute;dico en el centro</label>\r\n                        <input type=\"text\" class=\"form-control\" readonly value={$dataCita.ubicacion || \"\"}>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-lg-12\">\r\n                      <div class=\"form-group \">\r\n                        <label class=\"font-secondary\">Observaciones</label>\r\n                        <textarea class=\"form-control\" rows=\"5\" bind:value={obj.Observaciones}/>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-lg-12 p-t-80\" style=\"text-align: right;\">\r\n                      <button type=\"submit\" class=\"btn btn-success\" style=\"position: fixed; height: 50px; width: 50px; border-radius: 50%; right: 40px; bottom: 40px;\" title=\"Guardar\">\r\n                        <i class=\"mdi mdi-content-save-outline\" style=\"font-size: 23px;\"/>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n<!-- Modal -->\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalPacientes\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalPacientes\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalPacientes\">Buscar pacientes</h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n\r\n        <div class=\"input-group input-group-flush mb-3\">\r\n          <input\r\n            type=\"search\"\r\n            class=\"form-control form-control-appended\"\r\n            placeholder=\"Buscar\"\r\n            bind:value={busquedaPacientes} on:input={cargarPacientes}/>\r\n          <div class=\"input-group-append\">\r\n            <div class=\" input-group-text\">\r\n              <span class=\"mdi mdi-magnify\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"list-group list \">\r\n          {#each pacientes as i}\r\n          <div\r\n            style=\"cursor:pointer;\"\r\n            class=\"list-group-item d-flex align-items-center link-pacientes\"\r\n            on:click={seleccionarPaciente(i)}>\r\n            <div class=\"row\">\r\n              <div class=\"text-primary\">\r\n                <div class=\"name\">\r\n                  <span class=\"nombre-apellido\" style=\"font-weight: bold;\">{i.nombre} {i.apellidos}</span>\r\n                  »\r\n                  <span>Tel.: {i.telefono}</span>\r\n                  »\r\n                  <span>ID: {i.cedula || '\\\"Ningulo\\\"'}</span>\r\n                </div>\r\n                <div class=\"text-muted\">\r\n                  {i.direccion}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {/each}\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <div class=\"row text-center p-b-5\">\r\n          <div class=\"col\">\r\n            <a href=\"#!\" class=\"btn btn-secondary\" data-dismiss=\"modal\">\r\n              Cerrar\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
    "<script>\r\n    import Aside from \"../../Layout/Aside.svelte\";\r\n    import Header from \"../../Layout/Header.svelte\";\r\n    import { push, link } from \"svelte-spa-router\";\r\n    import { activePage, dataCita, axios, session, errorConexion, toast } from \"../../store\";\r\n    import { onMount } from \"svelte\";\r\n    import moment from 'moment';\r\n    import Swal from 'sweetalert2';\r\n\r\n    let pacientes = []\r\n    let inpBuscarPaciente = []\r\n    let pacienteFormulario = []\r\n    let modalidadesServicios = []\r\n    let servicios = []\r\n    let sltModalidad = ''\r\n    let sltServicio = ''\r\n    let inpFecha = ''\r\n    let horasServicios = []\r\n    let sltHora = ''\r\n    let txtObservaciones = ''\r\n    let nombrePaciente = ''\r\n    let apellidosPaciente = ''\r\n    let telefonoPaciente = ''\r\n    let correoPaciente = ''\r\n    let direccionPaciente = ''\r\n    \r\n    function seleccionarPaciente(id){\r\n        let paciente = pacientes.filter(x => x.id == id)\r\n        pacienteFormulario = paciente[0]\r\n        console.log(pacienteFormulario)\r\n        jQuery('#modalPacientes').modal('hide')\r\n    }\r\n\r\n    function cargarPacientes(){\r\n        setTimeout(function(){\r\n            $axios.get(`/pacientes?keyword=${inpBuscarPaciente}`)\r\n            .then(res => {\r\n                pacientes = res.data\r\n            })\r\n        },1000)\r\n    }\r\n\r\n    function cargarModalidades(){\r\n        $axios.get(`/modalidadesServicios`)\r\n            .then(res => {\r\n                modalidadesServicios = res.data\r\n            })\r\n    }\r\n\r\n    function cargarServicios(){\r\n        $axios.get(`/servicios`)\r\n            .then(res => {\r\n                servicios = res.data\r\n            })\r\n    }\r\n\r\n    function cargarHorasServicios(){\r\n        let filtro = {\r\n            fecha: inpFecha,\r\n            modalidadId: sltModalidad\r\n        }\r\n        let query = new URLSearchParams(filtro).toString()\r\n        $axios.get(`/servicios/${sltServicio}/disponibilidad?${query}`)\r\n            .then(res => {\r\n                horasServicios = res.data\r\n            })\r\n    }\r\n\r\n    function guardarCita(idPaciente){\r\n        let fechaHora = inpFecha + 'T' + sltHora\r\n        let objCita = {\r\n            ServicioId: sltServicio,\r\n            PacienteId: idPaciente,\r\n            AseguradoraId: pacienteFormulario.aseguradoraId,\r\n            Fecha: fechaHora,\r\n            Observaciones: txtObservaciones,\r\n            ModalidadId: sltModalidad\r\n        }\r\n        if(idPaciente){\r\n            $axios.post(`/citas`, objCita)\r\n                .then(res => {\r\n                    console.log(res.data)\r\n                    sltModalidad = ''\r\n                    sltServicio = ''\r\n                    inpFecha = ''\r\n                    horasServicios = []\r\n                    sltHora = ''\r\n                    txtObservaciones = ''\r\n                    pacienteFormulario.nombre = ''\r\n                    pacienteFormulario.apellidos = ''\r\n                    pacienteFormulario.telefono = ''\r\n                    pacienteFormulario.email = ''\r\n                    pacienteFormulario.direccion = ''\r\n                    pacienteFormulario.id = ''\r\n                })\r\n        }else{\r\n            let form = new FormData()\r\n            form.append('nombre', pacienteFormulario.nombre)\r\n            form.append('apellidos', pacienteFormulario.apellidos)\r\n            form.append('telefono', pacienteFormulario.telefono)\r\n            form.append('email', pacienteFormulario.email)\r\n            // form.append('municipioId', null)\r\n            // form.append('userId', null)\r\n            // form.append('provinciaId', null)\r\n            form.append('noParentesco', true)\r\n            form.append('direccion', pacienteFormulario.direccion)\r\n\r\n            $axios.post(`/pacientes`, form)\r\n                .then(res => {\r\n                    let idPaciente = res.data.data\r\n                    let objCita = {\r\n                        ServicioId: sltServicio,\r\n                        PacienteId: idPaciente,\r\n                        AseguradoraId: 6,\r\n                        Fecha: fechaHora,\r\n                        Observaciones: txtObservaciones,\r\n                        ModalidadId: sltModalidad\r\n                    }\r\n                    $axios.post(`/citas`, objCita)\r\n                        .then(res => {\r\n                            console.log(res.data)\r\n                            sltModalidad = ''\r\n                            sltServicio = ''\r\n                            inpFecha = ''\r\n                            horasServicios = []\r\n                            sltHora = ''\r\n                            txtObservaciones = ''\r\n                            pacienteFormulario.nombre = ''\r\n                            pacienteFormulario.apellidos = ''\r\n                            pacienteFormulario.telefono = ''\r\n                            pacienteFormulario.email = ''\r\n                            pacienteFormulario.direccion = ''\r\n                            pacienteFormulario.id = ''\r\n                        })\r\n                })\r\n        }\r\n    }\r\n  \r\n    onMount(() => {\r\n        cargarPacientes()\r\n        cargarModalidades()\r\n        cargarServicios()\r\n    });\r\n\r\n  </script>\r\n  \r\n  <style>\r\n    .modal-slide-right .modal-body {\r\n      height: 100% !important;\r\n      top: 0;\r\n      overflow: auto;\r\n    }\r\n    .list-group-item {\r\n      border-top: none;\r\n      border-left: none;\r\n      border-right: none;\r\n      background-color: transparent;\r\n      border-radius: 0 !important;\r\n    }\r\n  \r\n    .link-pacientes {\r\n      width: 100%;\r\n      border-radius: 5px;\r\n    }\r\n  \r\n    .link-pacientes:hover {\r\n      background-color: rgba(241, 241, 241, 0.247);\r\n    }\r\n    .borde-derecho {\r\n      border-right: 1px solid rgb(236, 236, 236);\r\n    }\r\n    .nombre-apellido{\r\n      text-transform:capitalize !important\r\n    }\r\n  </style>\r\n  \r\n  <Aside />\r\n  \r\n  <main class=\"admin-main\">\r\n    <Header />\r\n    <section class=\"admin-content\">\r\n      <div class=\"container mt-3\">\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-12 mb-3 text-right\">\r\n            <a href=\"/Citas/Index\" class=\"btn btn-outline-primary\" use:link>Lista de citas</a>\r\n          </div>\r\n          <div class=\"col-lg-12 mb-5\">\r\n            <div class=\"card\">\r\n              <div class=\"card-header\">\r\n                <h5>\r\n                  <i class=\"mdi mdi-checkbox-intermediate\" />\r\n                  Creando cita\r\n                </h5>\r\n                <div class=\"card-controls\"></div>\r\n              </div>\r\n              <div class=\"card-body\">\r\n                <form class=\"row\" on:submit|preventDefault={() => guardarCita(pacienteFormulario.id)}>\r\n                  <div class=\"col-lg-5 borde-derecho\">\r\n                    <div class=\"col-lg-12 mt-2\" style=\"padding: 0; margin: 0;\">\r\n                        <button class=\"btn btn-primary btn-sm\" data-toggle=\"modal\" style=\"position: absolute; top: -30px; right: 0;\" data-target=\"#modalPacientes\" type=\"button\">\r\n                      <i class=\"mdi mdi-search-web\" />\r\n                      Buscar paciente\r\n                    </button>\r\n                    </div>\r\n  \r\n                    <div class=\"form-group\">\r\n                      <label for=\"inpNombre\">Nombre paciente <span class=\"text-danger\">*</span> </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        class=\"form-control\"\r\n                        id=\"inpNombre\"\r\n                        required bind:value={pacienteFormulario.nombre}/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"inpApellido\">Apellidos paciente <span class=\"text-danger\">*</span></label>\r\n                      <input\r\n                        type=\"text\"\r\n                        class=\"form-control\"\r\n                        id=\"inpApellido\"\r\n                        required bind:value={pacienteFormulario.apellidos}/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"inpTelefono\">Telefono / Celular <span class=\"text-danger\">*</span></label>\r\n                      <input\r\n                        type=\"tel\"\r\n                        class=\"form-control\"\r\n                        id=\"inpTelefono\"\r\n                        required bind:value={pacienteFormulario.telefono}/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"inpCorreo\">Correo electronico</label>\r\n                      <input\r\n                        type=\"email\"\r\n                        class=\"form-control\"\r\n                        id=\"inpCorreo\" bind:value={pacienteFormulario.email}/>\r\n                    </div>\r\n  \r\n                    <div class=\"form-group \">\r\n                      <label class=\"font-secondary\">Direccion</label>\r\n                      <textarea\r\n                        class=\"form-control\"\r\n                        rows=\"3\" bind:value={pacienteFormulario.direccion}/>\r\n                    </div>\r\n                    <p>Los campos con un ( <span class=\"text-danger\">*</span> ) son obligatorios</p>\r\n  \r\n                  </div>\r\n                  <div class=\"col-lg-7\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-lg-6\">\r\n                            <div class=\"form-group \">\r\n                              <label class=\"font-secondary\">Servicios</label>\r\n                              <select class=\"form-control js-select2\" id=\"sltMedicos\" on:change={cargarHorasServicios} bind:value={sltServicio} required>\r\n                                <option value={''} disabled selected>- Seleccionar -</option>\r\n                                {#each servicios as servicio}\r\n                                    <option value={servicio.id}>{servicio.descripcion}</option>\r\n                                {/each}\r\n                              </select>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div class=\"col-lg-6\">\r\n                            <div class=\"form-group \">\r\n                              <label class=\"font-secondary\">Modalidad</label>\r\n                              <select class=\"form-control\"\r\n                                required bind:value={sltModalidad} on:change={cargarHorasServicios}>\r\n                                <option value={''} disabled selected>- Seleccionar -</option>\r\n                                {#each modalidadesServicios as modalidad}\r\n                                    <option value={modalidad.id}>{modalidad.descripcion}</option>\r\n                                {/each}\r\n                              </select>\r\n                            </div>\r\n                          </div>\r\n\r\n                      <div class=\"col-lg-6\">\r\n                        <div class=\"form-group\">\r\n                          <label for=\"Fecha\">Fecha cita</label>\r\n                          <input\r\n                            type=\"date\"\r\n                            class=\"form-control mb-2\"\r\n                            id=\"Fecha\" required bind:value={inpFecha} on:change={cargarHorasServicios}/>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div class=\"col-lg-6\">\r\n                        <div class=\"form-group\">\r\n                          <label class=\"font-secondary\">Hora</label>\r\n                          <select class=\"form-control\"\r\n                            required bind:value={sltHora}>\r\n                            <option value={\"\"} disabled selected>- Seleccionar -</option>\r\n                            {#each horasServicios as hora}\r\n                                <option value={hora}>{hora}</option>\r\n                            {/each}\r\n                          </select>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-lg-12\">\r\n                        <div class=\"form-group \">\r\n                          <label class=\"font-secondary\">Observaciones</label>\r\n                          <textarea class=\"form-control\" rows=\"5\" bind:value={txtObservaciones}></textarea>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"col-lg-12 p-t-80\" style=\"text-align: right;\">\r\n                        <button type=\"submit\" class=\"btn btn-success\" style=\"position: fixed; height: 50px; width: 50px; border-radius: 50%; right: 40px; bottom: 40px;\" title=\"Guardar\">\r\n                          <i class=\"mdi mdi-content-save-outline\" style=\"font-size: 23px;\"/>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </main>\r\n  \r\n  <!-- Modal -->\r\n  <div\r\n    class=\"modal fade modal-slide-right\"\r\n    id=\"modalPacientes\"\r\n    tabindex=\"-1\"\r\n    role=\"dialog\"\r\n    aria-labelledby=\"modalPacientes\"\r\n    style=\"display: none; padding-right: 16px;\"\r\n    aria-modal=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"modalPacientes\">Buscar pacientes</h5>\r\n          <button\r\n            type=\"button\"\r\n            class=\"close\"\r\n            data-dismiss=\"modal\"\r\n            aria-label=\"Close\">\r\n            <span aria-hidden=\"true\">×</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n  \r\n          <div class=\"input-group input-group-flush mb-3\">\r\n            <input\r\n              type=\"search\"\r\n              class=\"form-control form-control-appended\"\r\n              placeholder=\"Buscar\" bind:value={inpBuscarPaciente} on:input={cargarPacientes}/>\r\n            <div class=\"input-group-append\">\r\n              <div class=\" input-group-text\">\r\n                <span class=\"mdi mdi-magnify\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {#each pacientes as paciente}\r\n               <!-- content here -->\r\n               <div class=\"list-group list \">\r\n                 <div\r\n                   style=\"cursor:pointer;\"\r\n                   class=\"list-group-item d-flex align-items-center link-pacientes\" on:click={() => seleccionarPaciente(paciente.id)}>\r\n                   <div class=\"row\">\r\n                     <div class=\"text-primary\">\r\n                       <div class=\"name\">\r\n                         <span class=\"nombre-apellido\" style=\"font-weight: bold;\">{paciente.nombre} {paciente.apellidos}</span>\r\n                         »\r\n                         <span>Tel.: {paciente.telefono}</span>\r\n                         »\r\n                         <span>ID: {paciente.cedula}</span>\r\n                       </div>\r\n                       <div class=\"text-muted\">\r\n                         {paciente.direccion}\r\n                       </div>\r\n                     </div>\r\n                   </div>\r\n                 </div>\r\n               </div>\r\n          {/each}\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <div class=\"row text-center p-b-5\">\r\n            <div class=\"col\">\r\n              <a href=\"#!\" class=\"btn btn-secondary\" data-dismiss=\"modal\">\r\n                Cerrar\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  ",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import { onMount } from \"svelte\";\r\n  import { activePage, dataCita, axios, session, errorConexion } from \"../../store\";\r\n  import moment from 'moment';\r\n  import Swal from 'sweetalert2';\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n\r\n  let ubicacion = \"\";\r\n  let dia = -1;\r\n  let especialidades = [];\r\n  let listado = [];\r\n  let tandas = [];\r\n  let horasDisponibles = [];\r\n\r\n  let filter = {\r\n    Nombre: \"\",\r\n    PerfilID: 0,\r\n    FechaCita: \"\",\r\n    TandaID: 0\r\n  }\r\n  let filterCita = {\r\n    MedicoId: \"\",\r\n    FechaCita: \"\",\r\n    TandaID: 0\r\n  }\r\n  if ($activePage == 'citas.crear') {\r\n    limpiarFiltro();\r\n  }\r\n\r\n  $activePage = \"gestor\"\r\n\r\n  onMount(() => {\r\n    if ($dataCita.fechaCita != undefined) {\r\n      filter.FechaCita = $dataCita.fechaCita;\r\n      filter.TandaID = $dataCita.tandaID\r\n    }\r\n\r\n    jQuery(\"#sltEspecialidad\").select2();\r\n    jQuery(\"#sltEspecialidad\").on(\"select2:select\", e => {\r\n      let data = e.params.data;\r\n      filter.PerfilID = parseInt(data.id);\r\n      filtrar('general');\r\n    });\r\n\r\n    marcarFecha();\r\n    cargarMedicos();\r\n    cargarEspecialidades();\r\n    cargarTandas();\r\n  });\r\n\r\n  function cargarMedicos() {\r\n    var qs = new URLSearchParams(filter).toString()\r\n    $axios.get(\"/Medicos/Query?\" + qs)\r\n    .then(res => {\r\n      listado = res.data;\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    });\r\n  }\r\n  function cargarEspecialidades() {\r\n    $axios.get(\"/Perfiles/GetAll\")\r\n    .then(res => {\r\n      especialidades = res.data;\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    });\r\n  }\r\n  function cargarTandas() {\r\n    $axios.get(\"/Tandas/GetAll\")\r\n    .then(res => {\r\n      tandas = res.data;\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    });\r\n  }\r\n  function buscarDisponibilidadHorario(idMedico) {\r\n    if (typeof idMedico === 'string') {\r\n      filterCita.MedicoId = idMedico;\r\n    }\r\n\r\n    if (filterCita.FechaCita == \"\") {\r\n      horasDisponibles = [];\r\n      return;\r\n    }\r\n\r\n    let params = \"date=\" + filterCita.FechaCita + \"&\" + \"tandiId=\" + filterCita.TandaID;\r\n    $axios.get(\"/Medicos/HorasDisponibles/\" + filterCita.MedicoId + \"?\" + params)\r\n    .then(res => {\r\n      horasDisponibles = res.data.map(e => {\r\n        return {\r\n          time : e,\r\n          hora : moment(e, 'LT').format('LT')\r\n        }\r\n      });\r\n    }).catch(err => {\r\n      horasDisponibles = [];\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n\r\n  function elegirTiempo(e) {\r\n    let countDia = parseInt(e.target.value);\r\n    let date = moment();\r\n    date.add(moment.duration(countDia, 'd'));\r\n\r\n    filter.FechaCita = date.format('YYYY-MM-DD');\r\n    cargarMedicos();\r\n  }\r\n  function crearCita(item) {\r\n    ubicacion = item.ubicacion;\r\n    filterCita.TandaID = filter.TandaID;\r\n    filterCita.FechaCita = filter.FechaCita || moment().format('YYYY-MM-DD');\r\n    buscarDisponibilidadHorario(item.id)\r\n\r\n    jQuery('#modalCrearCita').modal('show')\r\n  }\r\n  function irACita(time) {\r\n    $dataCita = {\r\n      fechaCita: filterCita.FechaCita,\r\n      tandaID: filterCita.TandaID,\r\n      hora: time,\r\n      medicoId: filterCita.MedicoId,\r\n      pacienteId: \"\",\r\n      ubicacion: ubicacion\r\n    };\r\n    push('/Cita/Crear');\r\n  }\r\n  function irAlPerfil(id) {\r\n    $dataCita = {\r\n      fechaCita: filter.FechaCita,\r\n      tandaID: filter.TandaID,\r\n      hora: \"\",\r\n      medicoId: id,\r\n      pacienteId: \"\"\r\n    };\r\n    push('/Medico/Perfil/' + id);\r\n  }\r\n  function filtrar(tipo) {\r\n    if (tipo == 'limpiar') {\r\n      dia = -1;\r\n    }\r\n    if (tipo == 'fecha') {\r\n      marcarFecha()\r\n    }\r\n\r\n    cargarMedicos();\r\n  }\r\n  function marcarFecha() {\r\n    if (filter.FechaCita == moment().format('YYYY-MM-DD')) {\r\n      dia = 0;\r\n    } else if (filter.FechaCita == moment().add(moment.duration(1, 'd')).format('YYYY-MM-DD')) {\r\n      dia = 1;\r\n    } else if (filter.FechaCita == moment().add(moment.duration(2, 'd')).format('YYYY-MM-DD')) {\r\n      dia = 2;\r\n    } else {\r\n      dia = -1;\r\n    }\r\n  }\r\n  function limpiarFiltro() {\r\n    filter.Nombre = \"\";\r\n    filter.PerfilID = 0;\r\n    filter.FechaCita = \"\";\r\n    filter.TandaID = 0;\r\n    $dataCita = {}\r\n\r\n    jQuery(\"#sltEspecialidad\").val(0).trigger('change');\r\n    filtrar('limpiar');\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .option-box label:after,\r\n  .option-box label:before {\r\n    top: 0;\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container-fluid mt-3\">\r\n      <h4>Gestión de citas</h4>\r\n      <div class=\"row\">\r\n        <div class=\"col-lg-4\">\r\n          <div class=\"card\">\r\n            <div class=\"card-body\">\r\n              <div class=\"form-group \">\r\n                <label class=\"font-secondary\">Médico</label>\r\n                <input type=\"text\" class=\"form-control\" bind:value={filter.Nombre} on:input={() => filtrar('medico')} />\r\n              </div>\r\n              <div class=\"form-group \">\r\n                <label class=\"font-secondary\">Especialidad</label>\r\n                <select class=\"form-control select2\" style=\"width: 100%;\" id=\"sltEspecialidad\"\r\n                  bind:value={filter.PerfilID} on:change={() => filtrar('especialidad')}>\r\n                  <option value={0}>Todas</option>\r\n                  {#each especialidades as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                  {/each}\r\n                </select>\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label for=\"inputAddress2\">Fecha</label>\r\n                <input\r\n                  type=\"date\"\r\n                  class=\"form-control mb-2\"\r\n                  id=\"inputAddress2\" \r\n                  bind:value={filter.FechaCita} on:input={() => filtrar('fecha')}/>\r\n\r\n                <div class=\"contenedor-dias\">\r\n                  <div class=\"option-box\">\r\n                    <input id=\"radio-new1\" name=\"tiempo\" type=\"radio\" \r\n                      value={0} on:change={elegirTiempo} bind:group={dia} />\r\n                    <label\r\n                      for=\"radio-new1\"\r\n                      style=\"height: 40px; padding: 3px 10px;\">\r\n                      <span class=\"radio-content\">\r\n                        <span class=\"h6 d-block\">Hoy</span>\r\n                      </span>\r\n                    </label>\r\n                  </div>\r\n                  <div class=\"option-box\">\r\n                    <input id=\"radio-new2\" name=\"tiempo\" type=\"radio\" \r\n                      value={1} on:change={elegirTiempo} bind:group={dia} />\r\n                    <label\r\n                      for=\"radio-new2\"\r\n                      style=\"height: 40px; padding: 3px 10px;\">\r\n                      <span class=\"radio-content\">\r\n                        <span class=\"h6 d-block\">Mañana</span>\r\n                      </span>\r\n                    </label>\r\n                  </div>\r\n                  <div class=\"option-box\">\r\n                    <input id=\"radio-new3\" name=\"tiempo\" type=\"radio\" \r\n                      value={2} on:change={elegirTiempo} bind:group={dia} />\r\n                    <label\r\n                      for=\"radio-new3\"\r\n                      style=\"height: 40px; padding: 3px 10px;\">\r\n                      <span class=\"radio-content\">\r\n                        <span class=\"h6 d-block\">En dos días</span>\r\n                      </span>\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n\r\n              <div class=\"form-group \">\r\n                <label class=\"font-secondary\">Tanda</label>\r\n                <select class=\"form-control\" bind:value={filter.TandaID} \r\n                  on:change={() => filtrar('tanda')}>\r\n                  <option value={0} selected>Todas</option>\r\n                  {#each tandas as item}\r\n                  <option value={item.id}>{item.nombre}</option>\r\n                  {/each}\r\n                </select>\r\n              </div>\r\n              <button on:click={limpiarFiltro} class=\"btn btn-secondary btn-block\">Limpiar</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-lg-8\">\r\n          <div class=\"table-responsive\">\r\n            <table class=\"table align-td-middle table-card\">\r\n              <thead>\r\n                <tr>\r\n                  <th />\r\n                  <th>Nombre</th>\r\n                  <th>Especialidad</th>\r\n                  <th>Telefono</th>\r\n                  <th />\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {#each listado as item}\r\n                  <!-- content here -->\r\n                  <tr>\r\n                    <td>\r\n                      <div class=\"avatar avatar-sm \">\r\n                        <img\r\n                          src=\"assets/img/products/item%20(1).jpg\"\r\n                          class=\"avatar-img avatar-sm rounded-circle\"\r\n                          alt=\"\" />\r\n                      </div>\r\n                    </td>\r\n                    <td>{item.name}</td>\r\n                    <td>{item.perfil}</td>\r\n                    <td>{item.phoneNumber}</td>\r\n                    <td style=\"text-align: right;\">\r\n                      <button class=\"btn btn-outline-primary btn-sm\"\r\n                        on:click={() => irAlPerfil(item.id)}>\r\n                        <i class=\"mdi mdi-contacts\" />\r\n                        Perfil\r\n                      </button>\r\n                      <button class=\"btn btn-outline-success btn-sm\" \r\n                        on:click={() => crearCita(item)}>\r\n                        <i class=\"mdi mdi-calendar-plus\" />\r\n                        Crear cita\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                {/each}\r\n              </tbody>\r\n            </table>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n\r\n\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalCrearCita\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalCrearCitaLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\" >\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalCrearCitaLabel\">\r\n          <i class=\"mdi mdi-calendar-plus\"></i>\r\n          Crear cita\r\n        </h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\" style=\"height: 100%; top: 0; overflow: auto;\">\r\n\r\n        <div class=\"row\">\r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group\">\r\n              <label for=\"inputAddress\">Fecha</label> \r\n              <input type=\"date\" class=\"form-control form-control-sm\"\r\n                bind:value={filterCita.FechaCita} on:change={buscarDisponibilidadHorario}>\r\n            </div>\r\n          </div> \r\n          <div class=\"col-lg-6\">\r\n            <div class=\"form-group \">\r\n              <label class=\"font-secondary\">Tanda</label>\r\n              <select class=\"form-control form-control-sm\"\r\n                bind:value={filterCita.TandaID} on:change={buscarDisponibilidadHorario}>\r\n                <option value={0} disabled>- Seleccionar -</option>\r\n                {#each tandas as i}\r\n                <option value={i.id}>{i.nombre}</option>\r\n                {/each}\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>  \r\n        <div class=\"list-group list\">\r\n          {#if horasDisponibles.length <= 0}\r\n            <div class=\"alert alert-success\" role=\"alert\">\r\n              No hay disponibilidad con este horario\r\n            </div>\r\n          {/if}\r\n          {#each horasDisponibles as i}\r\n          <div class=\"list-group-item d-flex align-items-center svelte-1nu1nbu\">\r\n            <div class=\"\">\r\n              <div class=\"name\">{i.hora}</div>\r\n            </div>\r\n            <div class=\"ml-auto\">\r\n              <button class=\"btn btn-outline-success btn-sm\"\r\n                on:click={() => irACita(i.time)}>Seleccionar</button>\r\n            </div>\r\n          </div>\r\n          {/each}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { connection, activePage, session, axios, errorConexion, toast } from \"../../store.js\";\r\n  import { UserManager } from \"../../util.js\";\r\n  import { onMount } from \"svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import moment from \"moment\";\r\n  import Swal from 'sweetalert2';\r\n  \r\n  let user = {};\r\n  user = new UserManager($session.authorizationHeader.Authorization)\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n  $activePage = \"espacioMedico\";\r\n\r\n  let citaPacienteActual = {};\r\n  let paciente = {};\r\n  let envioPacienteActual = \"\";\r\n  let pacienteSeleccionado = \"\";\r\n  let citas = [];\r\n\r\n  onMount(() => {\r\n    cargarPacientesActivos()\r\n    buscarPacientePendiente();\r\n  })\r\n\r\n  $connection.on(\"RecibirPaciente\", (pacienteID, tipo) => {\r\n    cargarPacientesActivos();\r\n    if (tipo == \"asignar\") {\r\n      envioPacienteActual = pacienteID || \"\"\r\n      getPaciente(envioPacienteActual, 'asistente')\r\n    }\r\n  });\r\n\r\n  function cargarPacientesActivos() {\r\n    $axios.get('/Medicos/' + user.nameid + \"/PacientesActivos\")\r\n    .then(res => {\r\n      citas = res.data.filter (e =>\r\n        moment(e.fecha).format(\"YYYY-MM-DD\") == moment().format(\"YYYY-MM-DD\")\r\n      );\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n  function getPaciente(id, via) {\r\n    if (id == \"\") {\r\n      return\r\n    }\r\n\r\n    $axios.get(\"/Pacientes/\" + id)\r\n      .then(res => {\r\n        if (via == 'asistente' || via == 'carga') {\r\n          citaPacienteActual = citas.find(x => x.pacienteID == envioPacienteActual)\r\n          if (citas.some(x => x.pacienteID == envioPacienteActual)) {\r\n            paciente = res.data;\r\n            pacienteSeleccionado = paciente.id\r\n          }\r\n        }\r\n        if (via == 'seleccion') {\r\n          paciente = res.data;\r\n          pacienteSeleccionado = paciente.id\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function terminarCita() {\r\n    if (Object.entries(citaPacienteActual).length > 0 && citaPacienteActual != undefined) {\r\n      citaPacienteActual.inactivo = true;\r\n      citaPacienteActual.estadoID = 3;\r\n      $axios.put(\"/Citas/\" + citaPacienteActual.id, citaPacienteActual)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          citaPacienteActual = {}\r\n          paciente = {}\r\n          envioPacienteActual = \"\";\r\n          cargarPacientesActivos();\r\n\r\n          $connection.invoke(\"EnviarAvisoDelPaciente\", user.nameid, \"\")\r\n            .catch(err => console.error(err));\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n    }\r\n  }\r\n  function cambiarDePaciente(id) {\r\n    Swal.fire({\r\n      title: 'Cambio de paciente',\r\n      text: \"Estas seguro que deseas cambiar de paciente?\",\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n      cancelButtonText: 'No',\r\n      confirmButtonText: 'Si'\r\n    }).then((result) => {\r\n      if (result.isConfirmed) {\r\n        $axios.post(\"/Medicos/\" + user.nameid + \"/AsignarPaciente?pacienteId=\" + id)\r\n        .then(res => {\r\n          if (!res.data.errors) {\r\n            envioPacienteActual = id;\r\n            citaPacienteActual = citas.find(x => x.pacienteID == id)\r\n            $connection.invoke(\"EnviarAvisoDelPaciente\", user.nameid, id)\r\n            .catch(err => console.error(err));\r\n\r\n            $toast(5000).fire({\r\n              icon: 'success',\r\n              title: 'Cambio realizado con exito'\r\n            })\r\n          } else {\r\n            Swal.fire({\r\n              title: 'Error',\r\n              text: 'Problema al cambiar paciente',\r\n              icon: 'error'\r\n            });\r\n          }\r\n\r\n        }).catch(err => {\r\n          console.error(err);\r\n          $errorConexion()\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  function buscarPacientePendiente() {\r\n    $axios.get(\"/Medicos/\" + user.nameid + \"/PacientePendiente\")\r\n      .then(res => {\r\n        envioPacienteActual = res.data.data;\r\n        getPaciente(envioPacienteActual, 'carga')\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n</script>\r\n\r\n<style>\r\n  .list-group-item {\r\n    border-radius: 0 !important;\r\n  }\r\n  .list-group-item:last-child {\r\n    border-bottom: none;\r\n  }\r\n  .list-group-item.activo {\r\n    background-color: #687ae8;\r\n    color: white;\r\n    border-radius: 3px !important;\r\n  }\r\n  .list-group-item.activo .text-muted {\r\n    color: white !important;\r\n  }\r\n  .active-select{\r\n    background-color: rgba(216, 216, 216, 0.205);\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container mt-3\">\r\n      <div class=\"row\">\r\n        <div class=\"col-lg-12 mb-3\" style=\"text-align: right;\">\r\n          <!-- <button type=\"submit\" class=\"btn btn-primary\">\r\n            <i class=\"mdi mdi-bell-ring-outline\" />\r\n            Llamar asistente\r\n          </button> -->\r\n          <button class:d-none={envioPacienteActual == \"\" || citaPacienteActual == undefined} \r\n            class=\"btn btn-success\" on:click={terminarCita}>\r\n            <i class=\"mdi mdi-check-all\" />\r\n            Terminar cita\r\n          </button>\r\n        </div>\r\n        <div class=\"col-lg-5\">\r\n          <div class=\"card m-b-20 card-vnc svelte-1e95eny\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">Lista de citas</h5>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"list-group list \">\r\n                {#each citas as item}\r\n                <div\r\n                  class=\"list-group-item d-flex align-items-center\r\n                  link-pacientes svelte-1p1f2vm active-select\" \r\n                  class:activo={envioPacienteActual == item.pacienteID}\r\n                  class:active-select={pacienteSeleccionado == item.pacienteID}\r\n                  style=\"cursor: pointer;\"\r\n                  on:click={() => { getPaciente(item.pacienteID, 'seleccion') }}\r\n                  on:dblclick={() => cambiarDePaciente(item.pacienteID)}>\r\n                  <div class=\"row\">\r\n                    <div class=\"\">\r\n                      <div class=\"name\">\r\n                        <span style=\"font-weight: bold;\">{item.nombrePaciente}</span>\r\n                        »\r\n                        <span>Ced.: {item.cedula || \"\"}</span>\r\n                      </div>\r\n                      <div class=\"text-muted\">{item.observaciones}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                {/each}\r\n\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-lg-7\">\r\n          <div class=\"card m-b-30\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">Paciente actual</h5>\r\n            </div>\r\n            <div class=\"card-body \">\r\n              <form id=\"frmPaciente\">\r\n                <input type=\"hidden\" name=\"IdUser\" value=\"0\" />\r\n                <div class=\"row\">\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Nombre</label>\r\n                    <input\r\n                      value={paciente.nombre || \"\"}\r\n                      type=\"name\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      name=\"Name\"\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Apellido</label>\r\n                    <input\r\n                      value={paciente.apellidos || \"\"}\r\n                      type=\"name\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      name=\"Name\"\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Cedula</label>\r\n                    <input\r\n                      type=\"name\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      value={paciente.cedula || \"\"}\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Telefono</label>\r\n                    <input\r\n                      value={paciente.telefono || \"\"}\r\n                      type=\"tel\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      name=\"Name\"\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-12\">\r\n                    <label for=\"\">Correo electronico</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      value={paciente.correo || \"\"}\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Aseguradora</label>\r\n                    <input\r\n                      value={paciente.nombreAseguradora || \"\"}\r\n                      type=\"email\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">No. Seguro</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      maxlength=\"200\"\r\n                      value={paciente.noAfiliado || \"\"} />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Pais</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      value={paciente.nacionalidad || \"\"}\r\n                      maxlength=\"200\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-6\">\r\n                    <label for=\"\">Provincia</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      class=\"form-control\"\r\n                      readonly\r\n                      maxlength=\"200\" \r\n                      value={paciente.provincia || \"\"}/>\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-12\">\r\n                    <label for=\"\">Direccion</label>\r\n                    <textarea\r\n                      class=\"form-control\"\r\n                      rows=\"2\"\r\n                      readonly\r\n                      value={paciente.direccion || \"\"} />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-12\">\r\n                    <label for=\"\">Observaciones</label>\r\n                    <textarea\r\n                      value={paciente.observaciones || \"\"}\r\n                      class=\"form-control\"\r\n                      rows=\"3\"\r\n                      name=\"Observaciones\" />\r\n                  </div>\r\n                  <br />\r\n\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </section>\r\n</main>\r\n",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import DiaSemana from \"../../Components/DiaSemana.svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import { activePage, dataCita, axios, session, errorConexion, toast } from \"../../store\";\r\n  import { UserManager } from \"../../util.js\";\r\n  import { onMount } from \"svelte\";\r\n  import moment from 'moment';\r\n  // import Swal from 'sweetalert2';\r\n\r\n  let user = new UserManager($session.authorizationHeader.Authorization)\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n\r\n  $activePage = \"mantenimiento.peril\";\r\n  export let params = {};\r\n  let id = params.id;\r\n\r\n  let medico = {\r\n    medicoID: \"\",\r\n    name: \"\",\r\n    email: \"\",\r\n    perfil: \"\",\r\n    phoneNumber: \"\",\r\n    ubicacion: \"\"\r\n  };\r\n  let usuario = {\r\n    medicoID: \"\",\r\n    name: \"\",\r\n    email: \"\",\r\n    perfilID: 0,\r\n    phoneNumber: \"\",\r\n    ubicacion: \"\"\r\n  };\r\n  \r\n  let prefijos = [\r\n    {value: 'Dr', name: 'Dr.'},\r\n    {value: 'Dra', name: 'Dra.'},\r\n    {value: 'Lic', name: 'Lic.'},\r\n    {value: 'Lida', name: 'Lida.'},\r\n    {value: 'Sr', name: 'Sr.'},\r\n    {value: 'Sra', name: 'Sra.'},\r\n  ]\r\n\r\n  let fecha = \"\";\r\n  let fechaBusquedaCita = \"\";\r\n  let tandaID = 0;\r\n  // let perfiles = [];\r\n  let horarios = [];\r\n  let tandas = [];\r\n  let horasDisponibles = [];\r\n  let citas = [];\r\n  let filterCitas = [];\r\n  let btnFechaDisponibilidad = 'h';\r\n  let btnFechaCita = '';\r\n  let cambioHorarioPermitido = false;\r\n\r\n  let diasSemana = [\r\n    {check: false, dia: 1, nombre: 'Lunes'},\r\n    {check: false, dia: 2, nombre: 'Martes'},\r\n    {check: false, dia: 3, nombre: 'Miercoles'},\r\n    {check: false, dia: 4, nombre: 'Jueves'},\r\n    {check: false, dia: 5, nombre: 'Viernes'},\r\n    {check: false, dia: 6, nombre: 'Sabado'},\r\n    {check: false, dia: 7, nombre: 'Domingo'},\r\n  ];\r\n\r\n  onMount(() => {\r\n    btnFechaCita = 's';\r\n\r\n    if ($dataCita.fechaCita == \"\" || $dataCita.fechaCita == undefined) {\r\n      fecha = moment().format('YYYY-MM-DD');\r\n      tandaID = 1;\r\n    } else {\r\n      fecha = $dataCita.fechaCita;\r\n      tandaID = $dataCita.tandaID\r\n    }\r\n\r\n    cargarMedicosDelAsistente();\r\n    cargarMedico();\r\n    buscarDisponibilidadHorario();\r\n    cargarHorarios();\r\n    cargarTandas();\r\n    cargarCitas();\r\n    // cargarPerfiles();\r\n  });\r\n\r\n  function cargarMedicosDelAsistente() {\r\n    $axios.get(\"/MedicosAsistentes/\" + user.nameid + \"/Medicos\")\r\n    .then(res => {\r\n        cambioHorarioPermitido = res.data.some(x => x.medicoID == id);\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarMedico() {\r\n    $axios.get(\"/Medicos/\" + id)\r\n    .then(res => {\r\n        medico = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarTandas() {\r\n    $axios.get(\"/Tandas/GetAll\")\r\n    .then(res => {\r\n        tandas = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarHorarios() {\r\n    $axios.get(\"/Medicos/Horarios/\" + id)\r\n    .then(res => {\r\n        horarios = res.data;\r\n\r\n        diasSemana = diasSemana.map(e => {\r\n          return {\r\n            check: horarios.some(i => i.dia == e.dia && !i.inactivo),\r\n            dia: e.dia,  // Numero del dia\r\n            nombre: e.nombre // Si es Lunes, Martes, ETC.\r\n          }\r\n        });\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarCitas() {\r\n    $axios.get(\"/Medicos/Citas/\" + id)\r\n    .then(res => {\r\n        let datosCita = res.data.map(x => {\r\n          return {\r\n            fecha: moment(x.fecha).format('LL'),\r\n            hora: moment(x.fecha).format('LT'),\r\n            observaciones: x.observaciones,\r\n            nombrePaciente: x.nombrePaciente\r\n          }\r\n        });\r\n        let diasUnicos = [...new Set( datosCita.map(e => { return e.fecha }) )]; // Eliminando dias repetidos\r\n        diasUnicos.sort()\r\n\r\n        citas = diasUnicos.map(e => {\r\n          let horas = datosCita.filter(i => i.fecha == e).map(e => {\r\n            return {\r\n              hora:  moment(e.hora, 'LT'),\r\n              nombrePaciente: e.nombrePaciente,\r\n              observaciones: e.observaciones\r\n            }\r\n          });\r\n\r\n          return {\r\n            fecha: e,\r\n            horas: horas.sort((e, i)=> e.hora - i.hora ).map(x => {\r\n              return {\r\n                hora : moment(x.hora).format('LT'),\r\n                nombrePaciente: x.nombrePaciente,\r\n                observaciones: x.observaciones\r\n              }\r\n            })\r\n          }\r\n        })\r\n        filterCitas = citas;\r\n        buscarCitas('s');\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  // function cargarPerfiles() {\r\n  //   $axios.get(\"/Perfiles/GetAll\")\r\n  //   .then(res => {\r\n  //       perfiles = res.data;\r\n  //     }).catch(err => {\r\n  //       console.error(err);\r\n  //       $errorConexion()\r\n  //     });\r\n  // }\r\n\r\n  function buscarDisponibilidadHorario() {\r\n    if (fecha == \"\" || tandaID <= 0) {\r\n      horasDisponibles = [];\r\n      return;\r\n    }\r\n\r\n    if (fecha == moment().format('YYYY-MM-DD')) {\r\n      btnFechaDisponibilidad = 'h';\r\n    } else if (fecha == moment().add(moment.duration(1, 'd')).format('YYYY-MM-DD')) {\r\n      btnFechaDisponibilidad = 'm';\r\n    } else {\r\n      btnFechaDisponibilidad = ''\r\n    }\r\n\r\n    let params = \"date=\" + fecha + \"&\" + \"tandiId=\" + tandaID;\r\n    $axios.get(\"/Medicos/HorasDisponibles/\" + id + \"?\" + params)\r\n    .then(res => {\r\n      horasDisponibles = res.data.map(e => {\r\n        return {\r\n          time : e,\r\n          hora : moment(e, 'LT').format('LT')\r\n        } \r\n      });\r\n    }).catch(err => {\r\n      horasDisponibles = [];\r\n      console.error(err); \r\n      $errorConexion()\r\n    })\r\n  }\r\n\r\n  function crearCita(hora) {\r\n    $dataCita = {\r\n      fechaCita: fecha,\r\n      tandaID: tandaID,\r\n      hora: hora,\r\n      medicoId: id,\r\n      ubicacion: medico.ubicacion\r\n    };\r\n    push('/Cita/Crear/');\r\n  }\r\n\r\n  function diaSiguiente(params) {\r\n    fecha = moment().add(moment.duration(1, 'd')).format('YYYY-MM-DD');\r\n    btnFechaDisponibilidad = 'm';\r\n\r\n    buscarDisponibilidadHorario();\r\n  }\r\n  function diaDeHoy(params) {\r\n    fecha = moment().format('YYYY-MM-DD');\r\n    btnFechaDisponibilidad = 'h';\r\n\r\n    buscarDisponibilidadHorario();\r\n  }\r\n  function buscarCitas(tipo) {\r\n    let hoy = moment();\r\n    btnFechaCita = tipo;\r\n\r\n    if (tipo == 'h') {\r\n      fechaBusquedaCita = hoy.format('YYYY-MM-DD');\r\n      filterCitas = citas.filter(e => e.fecha == hoy.format('LL'));\r\n    } else if (tipo == 'm') {\r\n      hoy.add(moment.duration(1, 'd'));\r\n      fechaBusquedaCita = hoy.format('YYYY-MM-DD')\r\n      filterCitas = citas.filter(e => e.fecha == hoy.format('LL'));\r\n    } else if (tipo == 's') {\r\n      fechaBusquedaCita = ''\r\n      filterCitas = citas.filter(e => moment(e.fecha).format('W') == hoy.format('W'));\r\n    } else {\r\n      if (fechaBusquedaCita == hoy.format('YYYY-MM-DD')) {\r\n        btnFechaCita = 'h';\r\n      } else if (fechaBusquedaCita == hoy.add(moment.duration(1, 'd')).format('YYYY-MM-DD')) {\r\n        btnFechaCita = 'm';\r\n      } else if (moment(fechaBusquedaCita).format('W') == hoy.format('W')) {\r\n        btnFechaCita = 's'\r\n      } else {\r\n        btnFechaCita = ''\r\n      }\r\n\r\n      filterCitas = citas.filter(e => e.fecha == moment(fechaBusquedaCita).format('LL'));\r\n    }\r\n  }\r\n\r\n  function editarUsuario() {\r\n    $axios.get(\"/Users/\" + id)\r\n    .then(res => {\r\n      usuario = res.data;\r\n      jQuery('#modalUsuario').modal('show');\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    });\r\n  }\r\n  function guardarUsuario() {\r\n    $axios.put(\"/Users/\" + id, usuario)\r\n    .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Medico actualizado con exito'\r\n          })\r\n          jQuery('#modalUsuario').modal('hide');\r\n          cargarMedico();\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n\r\n</script>\r\n\r\n<style>\r\n  .list-group-item:nth-child(2n+1) {\r\n    background-color: #3e46760c;\r\n  }\r\n  .list-group-item {\r\n    padding: 5px 5px 5px 10px;\r\n    border-right: 0;\r\n    border-left: 0;\r\n    border-radius: 0;\r\n  }\r\n  .list-group-item:first-child {\r\n    border-top: none;\r\n  }\r\n  .list-group-item:last-child {\r\n    border-bottom: none;\r\n  }\r\n  .card.card-vnc {\r\n    box-shadow: none;\r\n    border: #687ae8 solid 1px;\r\n  }\r\n  .btn-primary, .btn-write {\r\n    border: 1px solid #d3e0e9;\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container mt-3\">\r\n      <h5 class=\"pt-2 pb-2\">Perfil Medico</h5>\r\n      <div class=\"row list\">\r\n        <div class=\"col-sm-12 col-lg-4\">\r\n          <div class=\"card m-b-30\">\r\n            <div class=\"card-header\" />\r\n            <div class=\"card-body\">\r\n              <div class=\"text-center\">\r\n                <div>\r\n                  <div class=\"avatar avatar-xl avatar-online\">\r\n                    <img\r\n                      class=\"avatar-img rounded-circle\"\r\n                      src=\"assets/img/users/user-5.jpg\"\r\n                      alt=\"name\" />\r\n                  </div>\r\n                </div>\r\n                <h3 class=\"p-t-10 searchBy-name\">{medico.prefix} {medico.name}</h3>\r\n              </div>\r\n              <div class=\"text-muted text-center\">\r\n                {medico.perfil || \"\"}\r\n              </div>\r\n              <p class=\"text-muted text-center\" style=\"margin-bottom: 0;\">\r\n                {medico.email}\r\n              </p>\r\n              <p class=\"text-muted text-center\" style=\"margin-bottom: 0;\">\r\n                {medico.ubicacion || \"\"}\r\n              </p>\r\n              <p class=\"text-muted text-center\">{medico.phoneNumber}</p>\r\n              <div class=\"row text-center p-b-10\">\r\n                <div class=\"col\">\r\n                  <a\r\n                    href=\"#!\"\r\n                    on:click|preventDefault={() => {\r\n                      document\r\n                        .querySelector('.horarioEspecialista')\r\n                        .scrollIntoView({\r\n                          behavior: 'smooth',\r\n                          block: 'center'\r\n                        });\r\n                    }}>\r\n                    <h3 class=\"mdi mdi-timetable\"> </h3>\r\n                    <div class=\"text-overline\">Horario</div>\r\n\r\n                  </a>\r\n                </div>\r\n                <div class=\"col\">\r\n                  <a href=\"#/\" on:click|preventDefault={editarUsuario}>\r\n                    <h3 class=\"mdi mdi-account-edit\"> </h3>\r\n                    <div class=\"text-overline\">Editar Perfil</div>\r\n                  </a>\r\n\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"col-sm-12 col-md-12 col-lg-8\">\r\n          <div class=\"card m-b-30\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">\r\n                <i class=\"mdi mdi-calendar-search\" />\r\n                Disponibilidad\r\n              </h5>\r\n              <div class=\"card-controls\">\r\n                <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\r\n                  <button type=\"button\" class:btn-primary={btnFechaDisponibilidad == 'h'} \r\n                    class:btn-write={btnFechaDisponibilidad != 'h'} class=\"btn shadow-none btn-sm\" \r\n                    on:click={diaDeHoy}>\r\n                    <i class=\"mdi mdi-calendar\" />\r\n                    Hoy\r\n                  </button>\r\n                  <button type=\"button\" class:btn-primary={btnFechaDisponibilidad == 'm'}\r\n                    class:btn-write={!btnFechaDisponibilidad != 'm'} class=\"btn shadow-none btn-sm\"\r\n                    on:click={diaSiguiente}>\r\n                    Mañana\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n\r\n              <div class=\"row\">\r\n                <div class=\"col-lg-6\">\r\n                  <div class=\"form-group\">\r\n                    <label for=\"inputAddress\">Fecha</label>\r\n                    <input type=\"date\" class=\"form-control form-control-sm\"\r\n                      bind:value={fecha} on:input={buscarDisponibilidadHorario}/>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-lg-6\">\r\n                  <div class=\"form-group \">\r\n                    <label class=\"font-secondary\">Tanda</label>\r\n                    <!-- svelte-ignore a11y-no-onchange -->\r\n                    <select class=\"form-control form-control-sm js-select2\"\r\n                      bind:value={tandaID} on:change={buscarDisponibilidadHorario}>\r\n                      <option value=\"0\" disabled selected>- Seleccionar -</option>\r\n                      {#each tandas as i}\r\n                      <option value={i.id}>{i.nombre}</option>\r\n                      {/each}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              {#if horasDisponibles.length <= 0}\r\n              <div class=\"alert alert-success\" role=\"alert\">\r\n                No hay disponibilidad con este horario\r\n              </div>\r\n              {/if}\r\n\r\n              <div class=\"list-group list\">\r\n                {#each horasDisponibles as item}\r\n                <div class=\"list-group-item d-flex align-items-center\">\r\n                  <div class=\"\">\r\n                    <div class=\"name\">{item.hora}</div>\r\n                  </div>\r\n                  <div class=\"ml-auto\">\r\n                    <button\r\n                      class=\"btn btn-outline-success btn-sm\"\r\n                      on:click={crearCita(item.time)}>\r\n                      <i class=\"mdi mdi-calendar-plus\"></i>\r\n                      Crear cita\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                {/each}\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"col-lg-12\">\r\n          <div class=\"card m-b-30\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">\r\n                <i class=\"mdi mdi-calendar-multiselect\" />\r\n                Citas programadas\r\n              </h5>\r\n              <div class=\"card-controls\">\r\n\r\n                <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\r\n                  <input type=\"date\" class=\"form-control form-control-sm\"\r\n                    bind:value={fechaBusquedaCita} on:change={() => buscarCitas('f')}/>\r\n                  <button\r\n                    type=\"button\"\r\n                    class:btn-primary={btnFechaCita == 'h'} class:btn-write={btnFechaCita != 'h'}\r\n                    class=\"btn shadow-none btn-sm\"\r\n                    on:click={() => buscarCitas('h')}>\r\n                    Hoy\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    class:btn-primary={btnFechaCita == 'm'} class:btn-write={btnFechaCita != 'm'}\r\n                    class=\"btn shadow-none btn-sm\"\r\n                    on:click={() => buscarCitas('m')}>\r\n                    Mañana\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    class:btn-primary={btnFechaCita == 's'} class:btn-write={btnFechaCita != 's'}\r\n                    class=\"btn shadow-none btn-sm\"\r\n                    on:click={() => buscarCitas('s')}>\r\n                    Semana\r\n                  </button>\r\n                </div>\r\n\r\n              </div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              {#if filterCitas.length == 0}\r\n              <div class=\"alert alert-success\" role=\"alert\">\r\n                No hay citas programadas para este dia\r\n              </div>\r\n              {/if}\r\n\r\n              <div class=\"row\">\r\n                {#each filterCitas as i}\r\n                <div class=\"col-lg-6\">\r\n                  <div class=\"card m-b-20 card-vnc\">\r\n                    <div class=\"card-header\">\r\n                      <h5 class=\"m-b-0\">{i.fecha}</h5>\r\n                    </div>\r\n                    <div class=\"card-body\">\r\n    \r\n                      <div class=\"list-group list \">\r\n                        {#each i.horas as h}\r\n                        <div class=\"list-group-item d-flex align-items-center\">\r\n                          <div class=\"\">\r\n                            <div class=\"name text-primary\">\r\n                              {h.nombrePaciente}\r\n                            </div>\r\n                            <div class=\"text-muted\">\r\n                              <span>{h.hora}</span>\r\n                              -\r\n                              <span>{h.observaciones} (Observaciones)</span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        {/each}\r\n                      </div>\r\n\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                {/each}\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n          \r\n          {#if user.is('assistant') && cambioHorarioPermitido || user.isAny(['admin', 'operator'])}\r\n          <article class=\"card m-b-30 horarioEspecialista\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">\r\n                <i class=\"mdi mdi-calendar-text\" />\r\n                Horario del especialista\r\n              </h5>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              {#each diasSemana as item}\r\n              <DiaSemana on:cambioHorario={cargarHorarios} on:cambioHorario={buscarDisponibilidadHorario}\r\n                {item} {tandas} {horarios} medicoID={id} />\r\n              {/each}\r\n            </div>\r\n          </article>\r\n          {/if}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n<form id=\"frmUsuario\" on:submit|preventDefault={guardarUsuario}>\r\n  <div class=\"modal fade modal-slide-right\"\r\n    id=\"modalUsuario\"\r\n    tabindex=\"-1\"\r\n    role=\"dialog\"\r\n    aria-labelledby=\"modalUsuarioLabel\"\r\n    style=\"display: none; padding-right: 16px;\"\r\n    aria-modal=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"modalUsuarioLabel\">Usuario</h5>\r\n          <button\r\n            type=\"button\"\r\n            class=\"close\"\r\n            data-dismiss=\"modal\"\r\n            aria-label=\"Close\">\r\n            <span aria-hidden=\"true\">×</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"modal-body\" style=\"height: 100% !important; top: 0; overflow: auto;\">\r\n\r\n            <input type=\"hidden\" name=\"IdUser\" value=\"0\" />\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Prefijo</label>\r\n                <select\r\n                  class=\"form-control\"\r\n                  name=\"prefijo\"\r\n                  bind:value={usuario.prefix} required>\r\n                  <option value=\"\">- Seleccionar -</option>\r\n                  {#each prefijos as item}\r\n                    <option value={item.value}>{item.name}</option>\r\n                  {/each}\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Nombre Completo</label>\r\n                <input\r\n                  type=\"name\"\r\n                  class=\"form-control\"\r\n                  placeholder=\"Ing. John Doe\"\r\n                  bind:value={usuario.name}\r\n                  name=\"Name\"\r\n                  maxlength=\"200\"\r\n                  required />\r\n              </div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <label for=\"\">Usuario</label>\r\n                <input\r\n                  type=\"email\"\r\n                  class=\"form-control\"\r\n                  autocomplete=\"off\"\r\n                  name=\"UserName\"\r\n                  id=\"\"\r\n                  maxlength=\"100\" />\r\n              </div>\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Email</label>\r\n                <input\r\n                  type=\"email\"\r\n                  required\r\n                  class=\"form-control\"\r\n                  placeholder=\"usuario@correo.com\"\r\n                  bind:value={usuario.email}\r\n                  autocomplete=\"off\"\r\n                  name=\"Email\"\r\n                  id=\"txtCorreo\"\r\n                  maxlength=\"100\" />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Telefono</label>\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  data-mask=\"(000) 000-0000\"\r\n                  data-mask-clearifnotmatch=\"true\"\r\n                  autocomplete=\"off\"\r\n                  maxlength=\"14\"\r\n                  placeholder=\"(809) 000-0000\"\r\n                  bind:value={usuario.phoneNumber}/>\r\n              </div>\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Ubicacion</label>\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  autocomplete=\"off\"\r\n                  bind:value={usuario.ubicacion}/>\r\n              </div>\r\n\r\n              <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <label for=\"\">exequatur</label>\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  utocomplete=\"off\"\r\n                  name=\"Exequatur\"\r\n                  id=\"txtTelefono\" />\r\n              </div>\r\n              <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <select\r\n                  name=\"IdDepartamento\"\r\n                  class=\"js-select2 select2-hidden-accessible\"\r\n                  id=\"sltDepartamentos\"\r\n                  style=\"width: 100%;\"\r\n                  aria-hidden=\"true\"\r\n                  tabindex=\"-1\">\r\n                  <option value=\"\" />\r\n                  <option value=\"1\">Psiquiatría</option>\r\n                </select>\r\n                <span class=\"select2 select2-container select2-container--default\"\r\n                  dir=\"ltr\"\r\n                  style=\"width: 100%;\">\r\n                  <span class=\"selection\">\r\n                    <span class=\"select2-selection select2-selection--single\"\r\n                      role=\"combobox\"\r\n                      aria-haspopup=\"true\"\r\n                      aria-expanded=\"false\"\r\n                      tabindex=\"0\"\r\n                      aria-labelledby=\"select2-sltDepartamentos-container\">\r\n                      <span class=\"select2-selection__rendered\"\r\n                        id=\"select2-sltDepartamentos-container\"\r\n                        role=\"textbox\"\r\n                        aria-readonly=\"true\">\r\n                        <span class=\"select2-selection__placeholder\">\r\n                          - Departamento -\r\n                        </span>\r\n                      </span>\r\n                      <span class=\"select2-selection__arrow\" role=\"presentation\">\r\n                        <b role=\"presentation\" />\r\n                      </span>\r\n                    </span>\r\n                  </span>\r\n                  <span class=\"dropdown-wrapper\" aria-hidden=\"true\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <br />\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\"\r\n              class=\"btn btn-secondary\"\r\n              data-dismiss=\"modal\">\r\n              Cerrar\r\n            </button>\r\n            <button type=\"submit\" class=\"btn btn-success\">Guardar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n",
    "<script>\r\n    import Aside from \"../../Layout/Aside.svelte\";\r\n    import Header from \"../../Layout/Header.svelte\";\r\n    import { activePage, session, axios, toast } from \"../../store.js\";\r\n    import { onDestroy, onMount } from \"svelte\";\r\n    export let params = {}\r\n    \r\n    let solicitudDetalle = []\r\n    let paciente = []\r\n    let imagenesRecetas = []\r\n    let parentescos = []\r\n    let estados = []\r\n\r\n    function cargarDetalleSolicitud(){\r\n        $axios.get(`/solicitudes/${params.id}`)\r\n            .then(res => {\r\n                solicitudDetalle = res.data\r\n                paciente = res.data.paciente\r\n                cargarParentesco()\r\n            })\r\n    }\r\n\r\n    function cargarEstados(){\r\n        $axios.get(`/estadossolicitud`)\r\n            .then(res =>{\r\n            estados = res.data\r\n        })\r\n    }\r\n\r\n    function cargarParentesco(){\r\n        $axios.get(`/pacientes/${paciente.id}/parentescos`)\r\n            .then(res => {\r\n                parentescos = res.data\r\n            })\r\n    }\r\n\r\n    function cargarImagenSolicitud(){\r\n        $axios.get(`/solicitudes/${params.id}/attachments`)\r\n            .then(res => {\r\n                imagenesRecetas = res.data\r\n            })\r\n    }\r\n\r\n    function cambiarEstadoSolicitud(estado){\r\n        const datosSolicitud = {\r\n            Id :solicitudDetalle.id,\r\n            PacienteId :solicitudDetalle.pacienteId,\r\n            AseguradoraId :solicitudDetalle. aseguradoraId,\r\n            CategoriaAfiliado :solicitudDetalle.categoriaAfiliado,\r\n            NumeroAsegurado :solicitudDetalle.numeroAsegurado,\r\n            Colectivo :solicitudDetalle.colectivo,\r\n            EstadoId :estado,\r\n            Flag :solicitudDetalle.flag,\r\n            Codigo :solicitudDetalle.codigo,\r\n            Comentario :solicitudDetalle.comentario,\r\n            CreatedAt :solicitudDetalle.createdAt,\r\n            Autorizado :solicitudDetalle.autorizado,\r\n            NumeroAutorizacion :solicitudDetalle.numeroAutorizacion,\r\n            Modalidad :solicitudDetalle.modalidad,\r\n            MotivoSolicitud :solicitudDetalle.motivoSolicitud,\r\n        }\r\n        $axios.put(`/solicitudes/${solicitudDetalle.id}`, datosSolicitud)\r\n            .then(res => {\r\n                if(res.status == 200){\r\n                    $toast(5000).fire({\r\n                        icon: 'success',\r\n                        title: 'Se actualizado la solicitud'\r\n                    })\r\n                }else{\r\n                    alert('Ocurrio un error en el servidor')\r\n                }\r\n            })\r\n    }\r\n\r\n    onMount(()=>{\r\n        cargarDetalleSolicitud()\r\n        cargarImagenSolicitud()\r\n        cargarEstados()\r\n    })\r\n  </script>\r\n  \r\n  <Aside />\r\n  \r\n  <main class=\"admin-main\">\r\n    <Header />\r\n    <section class=\"admin-content\">\r\n        <div class=\"container-fluid mt-3\">\r\n            <h4>Detalle Solicitud <span class=\"badge badge-primary\">{solicitudDetalle.codigo}</span></h4>\r\n            <div class=\"row\">\r\n                <div class=\"col-lg-12 mb-4 mt-3\">\r\n                    {#each estados as estado}\r\n                         <div class=\"custom-control custom-radio custom-control-inline\">\r\n                             <input type=\"radio\" id={estado.id} value={estado.id} bind:group={solicitudDetalle.estadoId} on:click={() => cambiarEstadoSolicitud(estado.id)} name=\"Estado\" class=\"custom-control-input\">\r\n                             <label class=\"custom-control-label\" for={estado.id}>{estado.descripcion}</label>\r\n                         </div>\r\n                    {/each}\r\n                </div>\r\n            </div>\r\n            <div class=\"card m-b-30\">\r\n                <div class=\"card-header\">\r\n                    <div class=\"card-controls\">\r\n                        <span class=\"badge badge-primary\">Fecha: {new Date(solicitudDetalle.createdAt).toLocaleString()}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"card-body\">\r\n                    <div class=\"form-row\">\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"codigo\">Codigo Solicitud</label>\r\n                            <input type=\"text\" class=\"form-control\" value={solicitudDetalle.codigo} readonly id=\"codigo\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"catAfiliado\">Categoria de afiliado</label>\r\n                            <input type=\"text\" class=\"form-control\" value={solicitudDetalle.categoriaAfiliado} readonly id=\"catAfiliado\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"colectivo\">Colectivo</label>\r\n                            <input type=\"text\" class=\"form-control\" value={solicitudDetalle.colectivo} readonly id=\"colectivo\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"colectivo\">Motivo</label>\r\n                            <input type=\"text\" class=\"form-control\" value={solicitudDetalle.motivoSolicitud} readonly id=\"motivo\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"modalidad\">Modalidad</label>\r\n                            <input type=\"text\" class=\"form-control\" value={solicitudDetalle.modalidad} readonly id=\"modalidad\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-12 col-md-12\">\r\n                            <div class=\"form-group\">\r\n                                <label for=\"exampleFormControlTextarea1\">Sintomas</label>\r\n                                <textarea class=\"form-control\" style=\"width:100%\" disabled rows=\"3\">{solicitudDetalle.comentario}</textarea>\r\n                              </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"card m-b-30\">\r\n                <div class=\"card-header\">\r\n                    <h5 class=\"card-title m-b-0\">Datos personales </h5>\r\n                </div>\r\n                <div class=\"card-body\">\r\n                    <div class=\"form-row\">\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"nombre\">Nombre</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.nombre} readonly id=\"nombre\" placeholder=\"Email\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"apellido\">Apellidos</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.apellidos} readonly id=\"apellido\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"apodo\">Apodo</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.apodo} readonly id=\"apodo\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"cedula\">Cedula</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.cedula} readonly id=\"cedula\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"aseguradora\">Aseguradora</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.aseguradora} readonly id=\"aseguradora\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"afiliado\">No. Afiliado / NSS</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.noAfiliado} readonly id=\"afiliado\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"nacimiento\">Fecha de nacimiento</label>\r\n                            <input type=\"text\" class=\"form-control\" value={new Date(paciente.fechaNacimiento).toLocaleDateString('es-DO')} readonly id=\"nacimiento\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"sexo\">Sexo</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.sexo} readonly id=\"sexo\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"email\">Telefono</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.telefono} readonly id=\"telefono\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"email\">Celular</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.celular} readonly id=\"celular\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"email\">Correo electronico</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.email} readonly id=\"email\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"provincia\">Provincia</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.provincia} readonly id=\"provincia\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"municipio\">Municipio</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.municipio} readonly id=\"municipio\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"ciudad\">Ciudad</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.ciudad} readonly id=\"ciudad\">\r\n                        </div>\r\n                        <div class=\"form-group col-lg-4 col-md-6\">\r\n                            <label for=\"barrio\">Barrio</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.barrio} readonly id=\"barrio\">\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group col-lg-8 col-md-6\">\r\n                            <label for=\"direccion\">Direccion</label>\r\n                            <input type=\"text\" class=\"form-control\" value={paciente.ciudad} readonly id=\"direccion\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {#each parentescos as parentesco}\r\n            <h5><span class=\"badge badge-primary\">Datos de {parentesco.tipoParentesco}</span></h5>\r\n                 <div class=\"card m-b-30\">\r\n                     <div class=\"card-body\">\r\n                         <div class=\"form-row\">\r\n                             <div class=\"form-group col-lg-4 col-md-6\">\r\n                                 <label for=\"codigo\">Nombre</label>\r\n                                 <input type=\"text\" class=\"form-control\" value={parentesco.nombre} readonly>\r\n                             </div>\r\n                             <div class=\"form-group col-lg-4 col-md-6\">\r\n                                 <label for=\"catAfiliado\">Apellidos</label>\r\n                                 <input type=\"text\" class=\"form-control\" value={parentesco.apellidos} readonly>\r\n                             </div>\r\n                             <div class=\"form-group col-lg-4 col-md-6\">\r\n                                 <label for=\"colectivo\">Cedula</label>\r\n                                 <input type=\"text\" class=\"form-control\" value={parentesco.cedula} readonly>\r\n                             </div>\r\n                             <div class=\"form-group col-lg-4 col-md-6\">\r\n                                <label for=\"colectivo\">Telefono</label>\r\n                                <input type=\"text\" class=\"form-control\" value={parentesco.telefono} readonly>\r\n                            </div>\r\n                         </div>\r\n                     </div>\r\n                 </div>\r\n            {/each}\r\n            \r\n            <div class=\"card m-b-30 mb-5\">\r\n                <div class=\"card-header\">\r\n                    <h5 class=\"card-title m-b-0\">Archivos </h5>\r\n                </div>\r\n                <div class=\"card-body\">\r\n                    <div class=\"row\">\r\n                        <a href=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{paciente.imagenCedula}\" target=\"_blank\" class=\"col-lg-4\">\r\n                            <img src=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{paciente.imagenCedula}\" class=\"img-galeria img-thumbnail\" alt=\"cedula\"/>\r\n                        </a>\r\n                        <a href=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{paciente.imagenSeguro}\" target=\"_blank\" class=\"col-lg-4\">\r\n                            <img src=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{paciente.imagenSeguro}\" class=\"img-galeria img-thumbnail\" alt=\"cedula\"/>\r\n                        </a>\r\n                        {#each imagenesRecetas as img}\r\n                            <a href=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{img.name}\" target=\"_blank\" class=\"col-lg-4\">\r\n                                <img src=\"https://odyssey-api.cmsiglo21.app/api/archivos/storage/{img.name}\" class=\"img-galeria img-thumbnail\" alt=\"cedula\"/>\r\n                            </a>\r\n                        {/each}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div><br>\r\n\r\n    </section>\r\n  </main>\r\n\r\n  <style>\r\n      .img-galeria{\r\n          height: 200px;\r\n          object-fit: cover;\r\n          width: 100%;\r\n      }\r\n  </style>\r\n  ",
    "<script>\r\n  import Aside from \"../../Layout/Aside.svelte\";\r\n  import Header from \"../../Layout/Header.svelte\";\r\n  import { push } from \"svelte-spa-router\";\r\n  import { activePage, host, axios, session, errorConexion, toast } from \"../../store\";\r\n  import { onMount } from \"svelte\";\r\n  // import Swal from 'sweetalert2';\r\n\r\n  $axios.defaults.headers.common = {\r\n    Authorization: $session.authorizationHeader.Authorization\r\n  };\r\n\r\n  $activePage = \"mantenimiento.usuarios.index\";\r\n\r\n  $: filterRoles = roles.map(x => {\r\n    return {\r\n      id : x.id,\r\n      name : x.name,\r\n      displayName: x.displayName,\r\n      checked: rolesUser.some(y => y == x.name) // activando roles ya asignado al usuario\r\n    }\r\n  }).filter(x => x.displayName.toLowerCase().includes(busquedaRoles.toLowerCase())); // filtro de busqueda\r\n\r\n  let asistentesAsignado = [];\r\n  let asistentes = [];\r\n  let perfiles = [];\r\n  let roles = [];\r\n  let rolesUser = [];\r\n  let usuarios = [];\r\n  let prefijos = [\r\n    {value: 'Dr', name: 'Dr.'},\r\n    {value: 'Dra', name: 'Dra.'},\r\n    {value: 'Lic', name: 'Lic.'},\r\n    {value: 'Lida', name: 'Lida.'},\r\n    {value: 'Sr', name: 'Sr.'},\r\n    {value: 'Sra', name: 'Sra.'},\r\n  ]\r\n  let usuario = {\r\n    prefix: \"\",\r\n    name: \"\",\r\n    email: \"\",\r\n    phoneNumber: \"\",\r\n    passwordHash: \"\",\r\n    ubicacion: \"\",\r\n    isDoctor: false,\r\n    perfilID: null\r\n  };\r\n  let userID = \"\";\r\n  let busqueda = \"\";\r\n  let busquedaRoles = \"\";\r\n  let asistenteID = \"\";\r\n\r\n  onMount(() => {\r\n    cargarUsuarios();\r\n    cargarAsistentes();\r\n    cargarPerfil();\r\n    cargarRoles()\r\n  });\r\n\r\n  function cargarUsuarios() {\r\n    $axios.get(\"/Users?keyword=\" + busqueda)\r\n    .then(res => {\r\n        usuarios = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarDetalle(id) {\r\n    userID = id;\r\n    $axios.get(\"/Users/\" + id)\r\n    .then(res => {\r\n        userID = id\r\n        usuario = res.data;\r\n        if (usuario.isDoctor) {\r\n          cargarAsistentesAsignado();\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarPerfil() {\r\n    $axios.get(\"/Perfiles/GetAll\").then(res => {\r\n        perfiles = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarAsistentesAsignado() {\r\n    $axios.get(\"/Medicos/\" + userID + \"/Asistentes\")\r\n    .then(res => {\r\n        asistentesAsignado = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarAsistentes() {\r\n    $axios.get(\"/Users/assistant/All\")\r\n    .then(res => {\r\n        asistentes = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarRoles() {\r\n    $axios.get(\"/Roles\")\r\n    .then(res => {\r\n        roles = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n  function cargarRolesUser(id) {\r\n    userID = id;\r\n    $axios.get(\"Users/\" + userID + \"/Roles\")\r\n    .then(res => {\r\n        rolesUser = res.data;\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n  }\r\n\r\n  function guardar() {\r\n    if (userID == \"\") {\r\n      $axios.post(\"/Users\", usuario)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Usuario guardado con exito'\r\n          })\r\n          jQuery('#modalUsuario').modal('hide');\r\n          cargarUsuarios();\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n    } else {\r\n      $axios.put(\"/Users/\" + userID, usuario)\r\n      .then(res => {\r\n        if (res.data.success) {\r\n          $toast(5000).fire({\r\n            icon: 'success',\r\n            title: 'Usuario guardado con exito'\r\n          })\r\n          jQuery('#modalUsuario').modal('hide');\r\n          cargarUsuarios();\r\n        }\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      });\r\n    }\r\n  }\r\n  function agregarRol(rol, checked) {\r\n    checked = Boolean(checked)\r\n    if (checked) {\r\n      $axios.post('/Users/' + userID + \"/RemoveFrom?role=\" + rol)\r\n      .then(res => {\r\n        cargarRolesUser(userID)\r\n      }).catch(err => {\r\n        console.error(err);\r\n        $errorConexion()\r\n      })\r\n    } else {\r\n      $axios.post('/Users/' + userID + \"/AddTo?role=\" + rol)\r\n      .then(res => {\r\n        cargarRolesUser(userID)\r\n      }).catch(err => {\r\n        console.error(err); \r\n        $errorConexion()\r\n      })\r\n    }\r\n  }\r\n  function agregarAsistente() {\r\n    let obj = {\r\n      AsistenteID: asistenteID,\r\n      MedicoID: userID\r\n    }\r\n\r\n    if (asistentesAsignado.some(e => e.asistenteID == asistenteID && e.medicoID == userID)) {\r\n      return;\r\n    }\r\n\r\n    $axios.post('/MedicosAsistentes', obj)\r\n    .then(res => {\r\n      if (res.data.success) {\r\n        cargarAsistentesAsignado();\r\n      }\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n  function eliminarAsistente(item) {\r\n    let obj = {\r\n      AsistenteID: item.asistenteID,\r\n      MedicoID: item.medicoID\r\n    }\r\n    let qs = new URLSearchParams(obj).toString();\r\n\r\n    $axios.delete('/MedicosAsistentes?' + qs)\r\n    .then(res => {\r\n      if (res.data.success) {\r\n        cargarAsistentesAsignado();\r\n      }\r\n    }).catch(err => {\r\n      console.error(err);\r\n      $errorConexion()\r\n    })\r\n  }\r\n\r\n  function agregarNuevo() {\r\n    userID = \"\";\r\n    usuario = {\r\n      prefix: \"\",\r\n      name: \"\",\r\n      email: \"\",\r\n      phoneNumber: \"\",\r\n      passwordHash: \"\",\r\n      ubicacion: \"\",\r\n      isDoctor: false,\r\n      perfilID: null\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n<style>\r\n  .icon-rol {\r\n    color: #95aac9;\r\n  }\r\n</style>\r\n\r\n<Aside />\r\n\r\n<main class=\"admin-main\">\r\n  <Header />\r\n  <section class=\"admin-content\">\r\n    <div class=\"container\">\r\n      <div class=\"row\">\r\n\r\n        <div class=\"mt-4 col-md-12\">\r\n          <div class=\"row\">\r\n            <div class=\"col-md-5\">\r\n              <div class=\"input-group input-group-flush mb-3\">\r\n                <input\r\n                  type=\"search\"\r\n                  class=\"form-control form-control-appended\"\r\n                  placeholder=\"Buscar\"\r\n                  bind:value={busqueda}\r\n                  on:input={cargarUsuarios} />\r\n                <div class=\"input-group-append\">\r\n                  <div class=\"input-group-text\">\r\n                    <span class=\"mdi mdi-magnify\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <button class=\"btn m-b-30 ml-2 mr-2 ml-3 btn-primary\"\r\n              on:click={agregarNuevo}\r\n              data-toggle=\"modal\"\r\n              data-target=\"#modalUsuario\">\r\n              <i class=\"mdi mdi-account-plus\" />\r\n              Nuevo usuario\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"col-lg-12\">\r\n          <div class=\"card m-b-30\">\r\n            <div class=\"card-header\">\r\n              <h5 class=\"m-b-0\">Usuarios</h5>\r\n\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"m-b-30\">\r\n                <div class=\"table-responsive\">\r\n                  <table class=\"table align-td-middle\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Nombres</th>\r\n                        <!-- <th>Usuario</th> -->\r\n                        <th>Correo</th>\r\n                        <th />\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {#each usuarios as i}\r\n                        <tr>\r\n                          <td>\r\n                            <div class=\"avatar avatar-sm mr-2 d-block-sm\">\r\n                              <div class=\"avatar avatar-sm\">\r\n                                <span class=\"avatar-title rounded-circle \">{i.name[0]}</span>\r\n                              </div>\r\n                            </div>\r\n                            <span>{i.name}</span>\r\n                          </td>\r\n                          <td>{i.email}</td>\r\n                          <td>\r\n                            <div style=\"width: 150px; text-align: right;\" class=\"ml-auto\">\r\n                              {#if i.isDoctor}\r\n                              <a href=\"#/Medico/Perfil/{i.id}\">\r\n                                <i class=\" mdi-24px mdi mdi-doctor\" />\r\n                              </a>\r\n                              {/if}\r\n                              <a href=\"#!\"\r\n                                on:click={() => cargarDetalle(i.id)}\r\n                                data-toggle=\"modal\"\r\n                                style=\"cursor: pointer;\"\r\n                                data-placement=\"top\"\r\n                                data-target=\"#modalUsuario\"\r\n                                data-original-title=\"Modificar usuario\"\r\n                                class=\"icon-table hover-cursor\">\r\n                                <i class=\" mdi-24px mdi mdi-circle-edit-outline\" />\r\n                              </a>\r\n                              <a href=\"#!\"\r\n                                on:click={() => cargarRolesUser(i.id)}\r\n                                data-toggle=\"modal\"\r\n                                data-target=\"#modalRoles\"\r\n                                data-placement=\"bottom\"\r\n                                title=\"Asignar Roles\"\r\n                                class=\"icon-rol\">\r\n                                <i class=\" mdi-24px mdi mdi-security\" />\r\n                              </a>\r\n                              \r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      {/each}\r\n\r\n                    </tbody>\r\n                  </table>\r\n\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </section>\r\n</main>\r\n\r\n<form id=\"frmUsuario\" on:submit|preventDefault={guardar}>\r\n  <div class=\"modal fade modal-slide-right\"\r\n    id=\"modalUsuario\"\r\n    tabindex=\"-1\"\r\n    role=\"dialog\"\r\n    aria-labelledby=\"modalUsuarioLabel\"\r\n    style=\"display: none; padding-right: 16px;\"\r\n    aria-modal=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"modalUsuarioLabel\">Usuario</h5>\r\n          <button\r\n            type=\"button\"\r\n            class=\"close\"\r\n            data-dismiss=\"modal\"\r\n            aria-label=\"Close\">\r\n            <span aria-hidden=\"true\">×</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"modal-body\" style=\"height: 100% !important; top: 0; overflow: auto;\">\r\n\r\n            <input type=\"hidden\" name=\"IdUser\" value=\"0\" />\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Prefijo</label>\r\n                <select\r\n                  class=\"form-control\"\r\n                  name=\"prefijo\"\r\n                  bind:value={usuario.prefix} required>\r\n                  <option value=\"\" disabled>- Seleccionar -</option>\r\n                  {#each prefijos as item}\r\n                    <option value={item.value}>{item.name}</option>\r\n                  {/each}\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Nombre Completo</label>\r\n                <input\r\n                  type=\"name\"\r\n                  class=\"form-control\"\r\n                  placeholder=\"Ing. John Doe\"\r\n                  bind:value={usuario.name}\r\n                  name=\"Name\"\r\n                  maxlength=\"200\"\r\n                  required />\r\n              </div>\r\n            </div>\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <label for=\"\">Usuario</label>\r\n                <input\r\n                  type=\"email\"\r\n                  class=\"form-control\"\r\n                  autocomplete=\"off\"\r\n                  name=\"UserName\"\r\n                  id=\"\"\r\n                  maxlength=\"100\" />\r\n              </div>\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Email</label>\r\n                <input\r\n                  type=\"email\"\r\n                  required\r\n                  class=\"form-control\"\r\n                  placeholder=\"usuario@correo.com\"\r\n                  bind:value={usuario.email}\r\n                  autocomplete=\"off\"\r\n                  name=\"Email\"\r\n                  id=\"txtCorreo\"\r\n                  maxlength=\"100\" />\r\n              </div>\r\n            </div>\r\n            {#if userID == \"\"}\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Contraseña</label>\r\n                <input\r\n                  type=\"password\"\r\n                  class=\"form-control\"\r\n                  required\r\n                  bind:value={usuario.passwordHash}\r\n                  name=\"PasswordHash\"\r\n                  maxlength=\"50\" />\r\n              </div>\r\n            </div>\r\n            {/if}\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group col-md-12\">\r\n                <label for=\"\">Telefono</label>\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  data-mask=\"(000) 000-0000\"\r\n                  data-mask-clearifnotmatch=\"true\"\r\n                  autocomplete=\"off\"\r\n                  maxlength=\"14\"\r\n                  placeholder=\"(809) 000-0000\"\r\n                  bind:value={usuario.phoneNumber}/>\r\n              </div>\r\n              <div class=\"form-group col-md-12\">\r\n                <label class=\"cstm-switch\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    value=\"true\"\r\n                    name=\"EsMedico\"\r\n                    bind:checked={usuario.isDoctor}\r\n                    class=\"cstm-switch-input\" />\r\n                  <span class=\"cstm-switch-indicator \" />\r\n                  <span class=\"cstm-switch-description\">Es Medico</span>\r\n                </label>\r\n              </div>\r\n              {#if usuario.isDoctor}\r\n                <div class=\"form-group col-md-12\">\r\n                  <label for=\"\">Ubicacion</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    class=\"form-control\"\r\n                    bind:value={usuario.ubicacion} required/>\r\n                </div>\r\n                <div class=\"form-group col-md-12\">\r\n                  <label for=\"\">Perfil</label>\r\n                  <select class=\"form-control\" name=\"perfil\"\r\n                    bind:value={usuario.perfilID} required>\r\n                    <option value=\"\" disabled selected>- Seleccionar -</option>\r\n                    {#each perfiles as item}\r\n                      <option value={item.id}>{item.nombre}</option>\r\n                    {/each}\r\n                  </select>\r\n                </div>\r\n                {#if userID != \"\" && userID != undefined}\r\n                <div class=\"form-group col-md-12\">\r\n                  <label for=\"\">Asistentes</label>\r\n                  <!-- svelte-ignore a11y-no-onchange -->\r\n                  <select\r\n                    class=\"form-control\"\r\n                    name=\"asistentes\"\r\n                    bind:value={asistenteID}\r\n                    on:change={agregarAsistente}>\r\n                    <option value=\"\" disabled>- Agregar -</option>\r\n                    {#each asistentes as item}\r\n                    <option value={item.id}>{item.name}</option>\r\n                    {/each}\r\n                  </select>\r\n                </div>\r\n                <div class=\"agregados col-lg-12\">\r\n                  {#each asistentesAsignado as item}\r\n                  <button type=\"button\" \r\n                  class=\"btn btn-primary btn-block\"\r\n                  on:click={ () => eliminarAsistente(item) }>{item.nombreAsistente}</button>\r\n                  {/each}\r\n                </div>\r\n                {/if}\r\n              {/if}\r\n\r\n              <!-- <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <label for=\"\">exequatur</label>\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  utocomplete=\"off\"\r\n                  name=\"Exequatur\"\r\n                  id=\"txtTelefono\" />\r\n              </div> -->\r\n              <!-- <div class=\"form-group col-md-12\" style=\"display: none;\">\r\n                <select\r\n                  name=\"IdDepartamento\"\r\n                  class=\"js-select2 select2-hidden-accessible\"\r\n                  id=\"sltDepartamentos\"\r\n                  style=\"width: 100%;\"\r\n                  aria-hidden=\"true\"\r\n                  tabindex=\"-1\">\r\n                  <option value=\"\" />\r\n                  <option value=\"1\">Psiquiatría</option>\r\n                </select>\r\n                <span class=\"select2 select2-container select2-container--default\"\r\n                  dir=\"ltr\"\r\n                  style=\"width: 100%;\">\r\n                  <span class=\"selection\">\r\n                    <span class=\"select2-selection select2-selection--single\"\r\n                      role=\"combobox\"\r\n                      aria-haspopup=\"true\"\r\n                      aria-expanded=\"false\"\r\n                      tabindex=\"0\"\r\n                      aria-labelledby=\"select2-sltDepartamentos-container\">\r\n                      <span class=\"select2-selection__rendered\"\r\n                        id=\"select2-sltDepartamentos-container\"\r\n                        role=\"textbox\"\r\n                        aria-readonly=\"true\">\r\n                        <span class=\"select2-selection__placeholder\">\r\n                          - Departamento -\r\n                        </span>\r\n                      </span>\r\n                      <span class=\"select2-selection__arrow\" role=\"presentation\">\r\n                        <b role=\"presentation\" />\r\n                      </span>\r\n                    </span>\r\n                  </span>\r\n                  <span class=\"dropdown-wrapper\" aria-hidden=\"true\" />\r\n                </span>\r\n              </div> -->\r\n            </div>\r\n            <br />\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\"\r\n              class=\"btn btn-secondary\"\r\n              data-dismiss=\"modal\">\r\n              Cerrar\r\n            </button>\r\n            <button type=\"submit\" class=\"btn btn-success\">Guardar</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n<div\r\n  class=\"modal fade modal-slide-right\"\r\n  id=\"modalRoles\"\r\n  tabindex=\"-1\"\r\n  role=\"dialog\"\r\n  aria-labelledby=\"modalRolesLabel\"\r\n  style=\"display: none; padding-right: 16px;\"\r\n  aria-modal=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"modalRolesLabel\">Roles</h5>\r\n        <button\r\n          type=\"button\"\r\n          class=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">×</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n\r\n        <form id=\"\">\r\n          <input type=\"hidden\" name=\"idPaciente\" value=\"\" />\r\n          <p>\r\n            <span class=\"badge badge-soft-primary\" style=\"font-size: 17px;\" />\r\n          </p>\r\n          <div class=\"form-group floating-label\">\r\n            <label>Buscar</label>\r\n            <input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              bind:value={busquedaRoles}\r\n              placeholder=\"Buscar roles\" />\r\n          </div>\r\n          <div class=\"roles\">\r\n            {#each filterRoles as item}\r\n            <div class=\"lista-rol m-b-10\">\r\n              <label class=\"cstm-switch d-flex bd-highlight\">\r\n                <span class=\"cstm-switch-description mr-auto bd-highlight\">\r\n                  {item.displayName}\r\n                </span>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  name=\"option\"\r\n                  value={item.id}\r\n                  bind:checked={item.checked}\r\n                  on:click={() => agregarRol(item.name, item.checked)}\r\n                  class=\"cstm-switch-input\" />\r\n                <span class=\"cstm-switch-indicator bg-success bd-highlight\" />\r\n              </label>\r\n            </div>\r\n            {/each}\r\n\r\n          </div>\r\n        </form>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n"
  ],
  "names": [],
  "mappings": "AAmBE,KAAK,SAAS,eAAC,CAAC,AACd,UAAU,CAAE,IAAI,CAChB,MAAM,CAAE,OAAO,CAAC,KAAK,CAAC,GAAG,AAC3B,CAAC;ACpBC,SAAS,8BAAC,CAAC,AACb,OAAO,CAAE,YAAY,CACrB,QAAQ,CAAE,QAAQ,CAClB,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,AACd,CAAC,AACD,wBAAS,CAAC,GAAG,eAAC,CAAC,AACb,UAAU,CAAE,UAAU,CACtB,OAAO,CAAE,KAAK,CACd,QAAQ,CAAE,QAAQ,CAClB,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CACtB,aAAa,CAAE,GAAG,CAClB,SAAS,CAAE,uBAAQ,CAAC,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAC9D,YAAY,CAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,WAAW,AACxD,CAAC,AACD,wBAAS,CAAC,kBAAG,WAAW,CAAC,CAAC,AAAC,CAAC,AAC1B,eAAe,CAAE,MAAM,AACzB,CAAC,AACD,wBAAS,CAAC,kBAAG,WAAW,CAAC,CAAC,AAAC,CAAC,AAC1B,aAAa,EAAE,CAAE,KAAK,AACxB,CAAC,AACD,wBAAS,CAAC,kBAAG,WAAW,CAAC,CAAC,AAAC,CAAC,AAC1B,cAAc,CAAC,CAAE,MAAM,AACzB,CAAC,AACD,WAAW,uBAAS,CAAC,AACnB,EAAE,AAAC,CAAC,AACF,SAAS,CAAE,OAAO,IAAI,CAAC,AACzB,CAAC,AACD,IAAI,AAAC,CAAC,AACJ,SAAS,CAAE,OAAO,MAAM,CAAC,AAC3B,CAAC,AACH,CAAC;ACwMC,kBAAkB,8BAAC,CAAC,AAClB,GAAG,CAAE,CAAC,CACN,MAAM,CAAE,CAAC,AACX,CAAC,AAED,iCAAkB,CAAC,aAAa,eAAC,CAAC,AAChC,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,KAAK,CAAC,UAAU,AAC5B,CAAC,AAED,iCAAkB,CAAC,WAAW,eAAC,CAAC,AAC9B,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,IAAI,AAChB,CAAC;ACgGD,aAAa,4BAAC,CAAC,AACb,MAAM,CAAE,OAAO,AACjB,CAAC,AAED,2BAAa,CAAC,EAAE,cAAC,CAAC,AAChB,OAAO,CAAE,IAAI,AACf,CAAC,AAED,kBAAkB,4BAAC,CAAC,AAClB,GAAG,CAAE,CAAC,CACN,MAAM,CAAE,CAAC,AACX,CAAC,AAED,gCAAkB,CAAC,aAAa,cAAC,CAAC,AAChC,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,KAAK,CAAC,UAAU,AAC5B,CAAC,AAED,gCAAkB,CAAC,WAAW,cAAC,CAAC,AAC9B,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,IAAI,AAChB,CAAC,AACD,mBAAK,CAAC,EAAE,2BAAa,CAAC,AACpB,kBAAkB,CAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAC5C,eAAe,CAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CACpC,UAAU,CAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,AAC9B,CAAC;ACnMD,iCAAkB,CAAC,WAAW,eAAC,CAAC,AAC9B,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,IAAI,AAChB,CAAC,AAED,8CAAgB,WAAW,IAAI,CAAC,AAAC,CAAC,AAChC,gBAAgB,CAAE,SAAS,AAC7B,CAAC,AAED,gBAAgB,8BAAC,CAAC,AAChB,UAAU,CAAE,IAAI,CAChB,WAAW,CAAE,IAAI,CACjB,YAAY,CAAE,IAAI,CAClB,gBAAgB,CAAE,WAAW,CAC7B,aAAa,CAAE,CAAC,CAAC,UAAU,AAC7B,CAAC,AAED,eAAe,8BAAC,CAAC,AACf,KAAK,CAAE,IAAI,CACX,aAAa,CAAE,GAAG,AACpB,CAAC,AAED,6CAAe,MAAM,AAAC,CAAC,AACrB,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,AAC9C,CAAC,AACD,cAAc,8BAAC,CAAC,AACd,YAAY,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,AAC5C,CAAC,AACD,8CAAgB,CAAC,AACf,eAAe,UAAU,CAAC;EAC5B,CAAC;AC/DC,gCAAkB,CAAC,WAAW,cAAC,CAAC,AAC9B,MAAM,CAAE,IAAI,CAAC,UAAU,CACvB,GAAG,CAAE,CAAC,CACN,QAAQ,CAAE,IAAI,AAChB,CAAC,AACD,gBAAgB,4BAAC,CAAC,AAChB,UAAU,CAAE,IAAI,CAChB,WAAW,CAAE,IAAI,CACjB,YAAY,CAAE,IAAI,CAClB,gBAAgB,CAAE,WAAW,CAC7B,aAAa,CAAE,CAAC,CAAC,UAAU,AAC7B,CAAC,AAED,eAAe,4BAAC,CAAC,AACf,KAAK,CAAE,IAAI,CACX,aAAa,CAAE,GAAG,AACpB,CAAC,AAED,2CAAe,MAAM,AAAC,CAAC,AACrB,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,AAC9C,CAAC,AACD,cAAc,4BAAC,CAAC,AACd,YAAY,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,AAC5C,CAAC,AACD,4CAAgB,CAAC,AACf,eAAe,UAAU,CAAC;IAC5B,CAAC;ACQH,yBAAW,CAAC,mBAAK,MAAM,CACvB,yBAAW,CAAC,mBAAK,OAAO,AAAC,CAAC,AACxB,GAAG,CAAE,CAAC,AACR,CAAC;ACtCD,gBAAgB,8BAAC,CAAC,AAChB,aAAa,CAAE,CAAC,CAAC,UAAU,AAC7B,CAAC,AACD,8CAAgB,WAAW,AAAC,CAAC,AAC3B,aAAa,CAAE,IAAI,AACrB,CAAC,AACD,gBAAgB,OAAO,8BAAC,CAAC,AACvB,gBAAgB,CAAE,OAAO,CACzB,KAAK,CAAE,KAAK,CACZ,aAAa,CAAE,GAAG,CAAC,UAAU,AAC/B,CAAC,AACD,gBAAgB,sBAAO,CAAC,WAAW,eAAC,CAAC,AACnC,KAAK,CAAE,KAAK,CAAC,UAAU,AACzB,CAAC,AACD,4CAAc,CAAC,AACb,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,AAC9C,CAAC;ACuID,+BAAgB,WAAW,IAAI,CAAC,AAAC,CAAC,AAChC,gBAAgB,CAAE,SAAS,AAC7B,CAAC,AACD,gBAAgB,eAAC,CAAC,AAChB,OAAO,CAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CACzB,YAAY,CAAE,CAAC,CACf,WAAW,CAAE,CAAC,CACd,aAAa,CAAE,CAAC,AAClB,CAAC,AACD,+BAAgB,YAAY,AAAC,CAAC,AAC5B,UAAU,CAAE,IAAI,AAClB,CAAC,AACD,+BAAgB,WAAW,AAAC,CAAC,AAC3B,aAAa,CAAE,IAAI,AACrB,CAAC,AACD,KAAK,SAAS,eAAC,CAAC,AACd,UAAU,CAAE,IAAI,CAChB,MAAM,CAAE,OAAO,CAAC,KAAK,CAAC,GAAG,AAC3B,CAAC,AACD,2BAAY,CAAE,UAAU,eAAC,CAAC,AACxB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,AAC3B,CAAC;ACzDG,2BAAY,CAAC,AACT,MAAM,CAAE,KAAK,CACb,UAAU,CAAE,KAAK,CACjB,KAAK,CAAE,IAAI,AACf,CAAC;AC7BL,SAAS,cAAC,CAAC,AACT,KAAK,CAAE,OAAO,AAChB,CAAC"
}